<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üíò Test de Fuerza Relacional</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap");

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Rajdhani", sans-serif;
        background: #0a0a0a;
        background-image: radial-gradient(
            circle at 20% 80%,
            rgba(120, 119, 198, 0.3) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(255, 119, 198, 0.3) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 40%,
            rgba(120, 219, 226, 0.2) 0%,
            transparent 50%
          );
        min-height: 100vh;
        color: #ffffff;
        overflow-x: hidden;
        position: relative;
      }

      .cyber-grid {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: linear-gradient(
            rgba(0, 255, 255, 0.03) 1px,
            transparent 1px
          ),
          linear-gradient(90deg, rgba(0, 255, 255, 0.03) 1px, transparent 1px);
        background-size: 50px 50px;
        pointer-events: none;
        z-index: 1;
      }

      .floating-hearts {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 2;
      }

      .heart-3d {
        position: absolute;
        width: 40px;
        height: 36px;
        opacity: 0.7;
        animation: floatHeart3D 15s infinite linear;
        filter: drop-shadow(0 0 8px currentColor);
      }

      .heart-3d::before,
      .heart-3d::after {
        content: "";
        position: absolute;
        width: 20px;
        height: 32px;
        border-radius: 20px 20px 0 0;
        transform: rotate(-45deg);
        transform-origin: 0 100%;
        background: linear-gradient(
          135deg,
          #ff1493 0%,
          #ff69b4 50%,
          #ff1493 100%
        );
        box-shadow: inset -2px -2px 8px rgba(139, 0, 90, 0.7),
          inset 2px 2px 8px rgba(255, 105, 180, 0.7),
          0 0 15px rgba(255, 20, 147, 0.5);
      }

      .heart-3d::before {
        left: 20px;
      }

      .heart-3d::after {
        left: 0;
        transform: rotate(45deg);
        transform-origin: 100% 100%;
      }

      .heart-3d.cyan::before,
      .heart-3d.cyan::after {
        background: linear-gradient(
          135deg,
          #00ffff 0%,
          #40e0d0 50%,
          #00ffff 100%
        );
        box-shadow: inset -2px -2px 8px rgba(0, 128, 128, 0.7),
          inset 2px 2px 8px rgba(64, 224, 208, 0.7),
          0 0 15px rgba(0, 255, 255, 0.5);
      }

      .heart-3d.purple::before,
      .heart-3d.purple::after {
        background: linear-gradient(
          135deg,
          #9932cc 0%,
          #ba55d3 50%,
          #9932cc 100%
        );
        box-shadow: inset -2px -2px 8px rgba(72, 25, 99, 0.7),
          inset 2px 2px 8px rgba(186, 85, 211, 0.7),
          0 0 15px rgba(153, 50, 204, 0.5);
      }

      .heart-3d.orange::before,
      .heart-3d.orange::after {
        background: linear-gradient(
          135deg,
          #ff6b35 0%,
          #ff8c42 50%,
          #ff6b35 100%
        );
        box-shadow: inset -2px -2px 8px rgba(204, 54, 27, 0.7),
          inset 2px 2px 8px rgba(255, 140, 66, 0.7),
          0 0 15px rgba(255, 107, 53, 0.5);
      }

      @keyframes floatHeart3D {
        0% {
          transform: translateY(100vh) translateX(0) rotate(0deg) scale(0.8);
          opacity: 0;
        }
        10% {
          opacity: 0.7;
        }
        50% {
          transform: translateY(50vh) translateX(20px) rotate(180deg) scale(1.2);
          opacity: 0.8;
        }
        90% {
          opacity: 0.7;
        }
        100% {
          transform: translateY(-10vh) translateX(-20px) rotate(360deg)
            scale(0.8);
          opacity: 0;
        }
      }

      .neon-particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 3;
      }

      .particle {
        position: absolute;
        width: 3px;
        height: 3px;
        background: #00ffff;
        border-radius: 50%;
        box-shadow: 0 0 8px #00ffff;
        animation: particleFloat 8s infinite ease-in-out;
      }

      @keyframes particleFloat {
        0%,
        100% {
          transform: translateY(0) translateX(0);
          opacity: 0.3;
        }
        50% {
          transform: translateY(-25px) translateX(25px);
          opacity: 1;
        }
      }

      .container {
        max-width: 100%;
        margin: 0 auto;
        padding: 10px;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        z-index: 10;
      }

      .screen {
        background: rgba(5, 5, 5, 0.95);
        backdrop-filter: blur(25px);
        border-radius: 20px;
        padding: 20px;
        width: 100%;
        max-width: 500px;
        box-shadow: 0 0 40px rgba(0, 255, 255, 0.2),
          inset 0 0 40px rgba(255, 20, 147, 0.1), 0 8px 32px rgba(0, 0, 0, 0.8);
        border: 2px solid transparent;
        background-clip: padding-box;
        position: relative;
        transform: translateY(20px) scale(0.95);
        opacity: 0;
        animation: screenGlow 0.8s ease forwards;
        display: none;
      }

      .screen::before {
        content: "";
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        background: linear-gradient(45deg, #00ffff, #ff1493, #9932cc, #00ffff);
        border-radius: 20px;
        z-index: -1;
        animation: borderGlow 3s ease infinite;
      }

      @keyframes borderGlow {
        0%,
        100% {
          opacity: 0.6;
        }
        50% {
          opacity: 1;
        }
      }

      .screen.active {
        display: block;
      }

      @keyframes screenGlow {
        to {
          transform: translateY(0) scale(1);
          opacity: 1;
        }
      }

      h1 {
        text-align: center;
        font-family: "Orbitron", monospace;
        background: linear-gradient(45deg, #00ffff, #ff1493, #9932cc);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 15px;
        font-size: 1.8rem;
        font-weight: 900;
        text-transform: uppercase;
        letter-spacing: 2px;
        animation: titlePulse 2s ease-in-out infinite;
        text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        line-height: 1.2;
      }

      @keyframes titlePulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.02);
        }
      }

      h2 {
        text-align: center;
        color: #ffffff;
        background: rgba(0, 0, 0, 0.8);
        padding: 12px 20px;
        border-radius: 12px;
        margin-bottom: 20px;
        font-size: 1.3rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        animation: fadeInUp 1s ease 0.3s both;
        text-shadow: 0 0 15px rgba(0, 255, 255, 0.8);
        border: 1px solid rgba(0, 255, 255, 0.3);
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .subtitle {
        text-align: center;
        color: #ffffff;
        background: rgba(0, 0, 0, 0.8);
        padding: 15px;
        border-radius: 12px;
        margin-bottom: 20px;
        font-size: 1rem;
        line-height: 1.5;
        animation: fadeInUp 1s ease 0.5s both;
        font-weight: 500;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .role-selector {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin: 25px 0;
      }

      .role-btn {
        padding: 20px 15px;
        border: 2px solid #333;
        border-radius: 15px;
        background: rgba(0, 0, 0, 0.9);
        cursor: pointer;
        transition: all 0.4s ease;
        text-align: center;
        font-size: 1rem;
        font-weight: 700;
        position: relative;
        overflow: hidden;
        color: #ffffff;
        text-transform: uppercase;
        letter-spacing: 1px;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
      }

      .role-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(0, 255, 255, 0.2),
          transparent
        );
        transition: left 0.6s;
      }

      .role-btn:hover {
        transform: scale(1.05);
        border-color: #00ffff;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.4),
          inset 0 0 20px rgba(0, 255, 255, 0.1);
      }

      .role-btn:hover::before {
        left: 100%;
      }

      .role-btn.selected {
        background: rgba(0, 0, 0, 0.95);
        border-color: #ff1493;
        box-shadow: 0 0 30px rgba(255, 20, 147, 0.5),
          inset 0 0 20px rgba(255, 20, 147, 0.2);
        animation: selectedGlow 0.6s ease;
      }

      @keyframes selectedGlow {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.08);
        }
        100% {
          transform: scale(1.05);
        }
      }

      .role-icon {
        font-size: 2.5rem;
        margin-bottom: 10px;
        display: block;
        filter: drop-shadow(0 0 8px currentColor);
      }

      .btn {
        width: 100%;
        padding: 15px 30px;
        border: none;
        border-radius: 15px;
        background: linear-gradient(135deg, #ff1493, #00ffff, #9932cc);
        background-size: 200% 200%;
        color: #ffffff;
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.4s ease;
        margin-top: 20px;
        position: relative;
        overflow: hidden;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-family: "Orbitron", monospace;
        animation: buttonPulse 2s ease infinite;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
      }

      @keyframes buttonPulse {
        0%,
        100% {
          background-position: 0% 50%;
          box-shadow: 0 0 15px rgba(255, 20, 147, 0.4);
        }
        50% {
          background-position: 100% 50%;
          box-shadow: 0 0 25px rgba(0, 255, 255, 0.6);
        }
      }

      .btn:hover {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 8px 20px rgba(255, 20, 147, 0.5);
      }

      .btn:active {
        transform: translateY(-1px) scale(0.98);
      }

      .btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
        transform: none;
        animation: none;
      }

      .question {
        margin-bottom: 25px;
        padding: 20px;
        background: rgba(0, 0, 0, 0.9);
        border-radius: 15px;
        border: 1px solid #333;
        transition: all 0.3s ease;
        animation: questionSlide 0.6s ease forwards;
        opacity: 0;
        transform: translateX(-30px);
      }

      .question:hover {
        border-color: #00ffff;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        transform: translateY(-2px);
      }

      @keyframes questionSlide {
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .question h3 {
        color: #ffffff;
        margin-bottom: 15px;
        font-size: 1rem;
        line-height: 1.4;
        font-weight: 600;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        background: rgba(0, 0, 0, 0.5);
        padding: 10px;
        border-radius: 8px;
        border-left: 3px solid #00ffff;
      }

      .likert-scale {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 8px;
        margin-top: 15px;
      }

      .likert-option {
        display: flex;
        flex-direction: column;
        align-items: center;
        cursor: pointer;
      }

      .likert-option input[type="radio"] {
        display: none;
      }

      .likert-circle {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        border: 2px solid #333;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 1rem;
        color: #ffffff;
        transition: all 0.3s ease;
        margin-bottom: 8px;
        position: relative;
        background: rgba(0, 0, 0, 0.9);
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
      }

      .likert-option:hover .likert-circle {
        border-color: #00ffff;
        color: #00ffff;
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        transform: scale(1.1);
      }

      .likert-option input[type="radio"]:checked + .likert-circle {
        background: linear-gradient(135deg, #ff1493, #00ffff);
        border-color: #ff1493;
        color: #ffffff;
        box-shadow: 0 0 20px rgba(255, 20, 147, 0.7),
          inset 0 0 15px rgba(0, 255, 255, 0.3);
        transform: scale(1.15);
        animation: checkGlow 0.6s ease;
      }

      @keyframes checkGlow {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.25);
        }
        100% {
          transform: scale(1.15);
        }
      }

      .likert-label {
        font-size: 0.75rem;
        color: #ffffff;
        text-align: center;
        line-height: 1.1;
        font-weight: 500;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        background: rgba(0, 0, 0, 0.7);
        padding: 4px 6px;
        border-radius: 6px;
      }

      .progress-bar {
        width: 100%;
        height: 12px;
        background: rgba(0, 0, 0, 0.8);
        border-radius: 12px;
        margin-bottom: 20px;
        overflow: hidden;
        position: relative;
        border: 2px solid #333;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #ff1493, #00ffff, #9932cc, #ff1493);
        background-size: 300% 100%;
        border-radius: 12px;
        transition: width 0.8s ease;
        width: 0%;
        animation: progressFlow 2s ease infinite;
        position: relative;
        box-shadow: 0 0 20px rgba(255, 20, 147, 0.6);
      }

      @keyframes progressFlow {
        0% {
          background-position: 0% 50%;
        }
        100% {
          background-position: 300% 50%;
        }
      }

      .transition-screen {
        text-align: center;
      }

      .transition-icon {
        font-size: 4rem;
        margin-bottom: 20px;
        animation: rotateGlow 2s ease infinite;
        filter: drop-shadow(0 0 15px #00ffff);
      }

      @keyframes rotateGlow {
        0%,
        100% {
          transform: rotate(0deg) scale(1);
        }
        25% {
          transform: rotate(90deg) scale(1.1);
        }
        50% {
          transform: rotate(180deg) scale(1);
        }
        75% {
          transform: rotate(270deg) scale(1.1);
        }
      }

      /* MODAL STYLES */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        z-index: 2000;
        animation: modalFadeIn 0.5s ease;
        padding: 10px;
      }

      .modal.active {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        background: rgba(5, 5, 5, 0.98);
        backdrop-filter: blur(30px);
        border-radius: 20px;
        padding: 25px;
        max-width: 95%;
        max-height: 95%;
        overflow-y: auto;
        position: relative;
        animation: modalSlideIn 0.6s ease;
        border: 2px solid transparent;
        background-clip: padding-box;
        width: 100%;
        max-width: 600px;
      }

      .modal-content::before {
        content: "";
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        background: linear-gradient(45deg, #00ffff, #ff1493, #9932cc, #00ffff);
        border-radius: 20px;
        z-index: -1;
        animation: borderGlow 2s ease infinite;
      }

      @keyframes modalFadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes modalSlideIn {
        from {
          transform: scale(0.8) translateY(30px);
          opacity: 0;
        }
        to {
          transform: scale(1) translateY(0);
          opacity: 1;
        }
      }

      /* DISCLAIMER MODAL */
      .disclaimer-modal {
        background: rgba(15, 15, 15, 0.98);
        border: 3px solid #ff6b35;
        max-width: 500px;
        text-align: center;
        animation: disclaimerPulse 2s ease infinite;
      }

      @keyframes disclaimerPulse {
        0%,
        100% {
          box-shadow: 0 0 0 0 rgba(255, 107, 53, 0.7);
          transform: scale(1);
        }
        50% {
          box-shadow: 0 0 0 15px rgba(255, 107, 53, 0);
          transform: scale(1.02);
        }
      }

      .disclaimer-content {
        color: #ffffff;
        font-size: 1.1rem;
        line-height: 1.6;
        margin-bottom: 25px;
        font-weight: 500;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
      }

      .age-input {
        width: 100%;
        padding: 15px;
        border-radius: 10px;
        border: 2px solid #333;
        background: rgba(0, 0, 0, 0.8);
        color: #fff;
        font-size: 1.1rem;
        text-align: center;
        margin: 20px 0;
        transition: all 0.3s ease;
      }

      .age-input:focus {
        outline: none;
        border-color: #00ffff;
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
      }

      .age-input::placeholder {
        color: #888;
      }

      .disclaimer-title {
        font-size: 1.5rem;
        font-weight: 800;
        color: #ff6b35;
        margin-bottom: 20px;
        font-family: "Orbitron", monospace;
        text-transform: uppercase;
      }

      /* RESULTS STYLES */
      .result-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .result-icon {
        font-size: 4rem;
        margin-bottom: 15px;
        animation: resultBounce 2s ease infinite;
        filter: drop-shadow(0 0 15px currentColor);
      }

      @keyframes resultBounce {
        0%,
        100% {
          transform: translateY(0) scale(1);
        }
        50% {
          transform: translateY(-10px) scale(1.05);
        }
      }

      .scores-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 20px;
        margin: 25px 0;
      }

      .score-display {
        background: rgba(0, 0, 0, 0.95);
        border-radius: 20px;
        padding: 25px;
        text-align: center;
        border: 2px solid #333;
        transition: all 0.3s ease;
        position: relative;
      }

      .score-display:hover {
        border-color: #00ffff;
        box-shadow: 0 0 25px rgba(0, 255, 255, 0.3);
        transform: translateY(-3px);
      }

      .score-number {
        font-size: 3.5rem;
        font-weight: 900;
        font-family: "Orbitron", monospace;
        background: linear-gradient(45deg, #ff1493, #00ffff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: scoreGlow 2s ease infinite;
        text-shadow: 0 0 20px rgba(255, 20, 147, 0.5);
      }

      @keyframes scoreGlow {
        0%,
        100% {
          filter: drop-shadow(0 0 8px rgba(255, 20, 147, 0.8));
        }
        50% {
          filter: drop-shadow(0 0 20px rgba(0, 255, 255, 0.8));
        }
      }

      .score-label {
        font-size: 1.1rem;
        color: #ffffff;
        margin-top: 8px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
      }

      .risk-level {
        padding: 10px 20px;
        border-radius: 25px;
        display: inline-block;
        font-weight: 700;
        margin: 12px 0;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-family: "Orbitron", monospace;
      }

      .risk-low {
        background: linear-gradient(135deg, #00ff88, #00ffaa);
        color: #000000;
        box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
      }

      .risk-medium {
        background: linear-gradient(135deg, #ffaa00, #ff8800);
        color: #000000;
        box-shadow: 0 0 15px rgba(255, 170, 0, 0.5);
      }

      .risk-high {
        background: linear-gradient(135deg, #ff0044, #ff0066);
        color: #ffffff;
        box-shadow: 0 0 15px rgba(255, 0, 68, 0.5);
      }

      /* PROFESSIONAL STATISTICS */
      .stats-container {
        margin: 20px 0;
        padding: 20px;
        background: rgba(0, 0, 0, 0.8);
        border-radius: 15px;
        border: 1px solid #333;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 15px;
        margin: 15px 0;
      }

      .stat-item {
        text-align: center;
        padding: 15px;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 12px;
        border: 1px solid #444;
      }

      .stat-value {
        font-size: 1.5rem;
        font-weight: 800;
        color: #00ffff;
        font-family: "Orbitron", monospace;
      }

      .stat-label {
        font-size: 0.8rem;
        color: #cccccc;
        margin-top: 5px;
        text-transform: uppercase;
      }

      .category-breakdown {
        margin: 20px 0;
      }

      .category-item {
        margin: 10px 0;
        padding: 15px;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 12px;
        border-left: 4px solid #00ffff;
      }

      .category-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }

      .category-name {
        font-weight: 600;
        color: #ffffff;
      }

      .category-score {
        font-weight: 700;
        color: #00ffff;
        font-family: "Orbitron", monospace;
      }

      .category-bar {
        width: 100%;
        height: 8px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        overflow: hidden;
      }

      .category-fill {
        height: 100%;
        background: linear-gradient(90deg, #ff1493, #00ffff);
        border-radius: 4px;
        transition: width 1s ease;
        animation: categoryGlow 2s ease infinite;
      }

      @keyframes categoryGlow {
        0%,
        100% {
          box-shadow: 0 0 5px rgba(255, 20, 147, 0.5);
        }
        50% {
          box-shadow: 0 0 15px rgba(0, 255, 255, 0.8);
        }
      }

      .couple-result {
        background: rgba(0, 0, 0, 0.95);
        border-radius: 20px;
        padding: 25px;
        margin: 25px 0;
        text-align: center;
        border: 2px solid #333;
      }

      .couple-classification {
        font-size: 1.5rem;
        font-weight: 800;
        margin: 15px 0;
        font-family: "Orbitron", monospace;
        background: linear-gradient(45deg, #ff1493, #00ffff, #9932cc);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .betrayal-index {
        font-size: 2.5rem;
        font-weight: 900;
        font-family: "Orbitron", monospace;
        color: #ff0044;
        margin: 15px 0;
        text-shadow: 0 0 15px rgba(255, 0, 68, 0.8);
        animation: betrayalPulse 2s ease infinite;
      }

      @keyframes betrayalPulse {
        0%,
        100% {
          transform: scale(1);
          text-shadow: 0 0 15px rgba(255, 0, 68, 0.8);
        }
        50% {
          transform: scale(1.03);
          text-shadow: 0 0 25px rgba(255, 0, 68, 1);
        }
      }

      .analysis-text {
        line-height: 1.5;
        color: #ffffff;
        margin: 15px 0;
        font-weight: 500;
        background: rgba(0, 0, 0, 0.7);
        padding: 15px;
        border-radius: 12px;
        border-left: 3px solid #00ffff;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        font-size: 0.95rem;
      }

      .modal-actions {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-top: 25px;
      }

      .close-modal {
        position: absolute;
        top: 15px;
        right: 20px;
        background: none;
        border: none;
        font-size: 2rem;
        cursor: pointer;
        color: #cccccc;
        width: auto;
        padding: 0;
        margin: 0;
        transition: all 0.3s ease;
      }

      .close-modal:hover {
        color: #ff1493;
        transform: scale(1.2) rotate(90deg);
        text-shadow: 0 0 15px #ff1493;
      }

      .sound-toggle {
        position: fixed;
        top: 15px;
        right: 15px;
        background: linear-gradient(135deg, #ff1493, #00ffff);
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 1.2rem;
        color: white;
        cursor: pointer;
        z-index: 1000;
        transition: all 0.3s ease;
        box-shadow: 0 0 15px rgba(255, 20, 147, 0.5);
      }

      .sound-toggle:hover {
        transform: scale(1.1);
        box-shadow: 0 0 25px rgba(0, 255, 255, 0.7);
      }

      .comparison-chart {
        margin: 20px 0;
        padding: 20px;
        background: rgba(0, 0, 0, 0.8);
        border-radius: 15px;
        border: 1px solid #333;
      }

      .chart-title {
        text-align: center;
        color: #00ffff;
        font-weight: 700;
        margin-bottom: 15px;
        font-family: "Orbitron", monospace;
      }

      .chart-bars {
        display: flex;
        justify-content: space-around;
        align-items: end;
        height: 150px;
        margin: 20px 0;
      }

      .chart-bar {
        width: 40px;
        background: linear-gradient(0deg, #ff1493, #00ffff);
        border-radius: 8px 8px 0 0;
        position: relative;
        transition: height 1.5s ease;
        box-shadow: 0 0 10px rgba(255, 20, 147, 0.5);
      }

      .chart-bar::after {
        content: attr(data-value) "%";
        position: absolute;
        top: -25px;
        left: 50%;
        transform: translateX(-50%);
        color: #ffffff;
        font-weight: 700;
        font-size: 0.9rem;
      }

      .chart-label {
        text-align: center;
        color: #cccccc;
        font-size: 0.8rem;
        margin-top: 10px;
        font-weight: 600;
      }

      /* Responsividad espec√≠fica */
      @media (max-width: 480px) {
        .container {
          padding: 5px;
        }

        .screen {
          padding: 15px;
          border-radius: 15px;
          margin: 5px;
        }

        h1 {
          font-size: 1.4rem;
          letter-spacing: 1px;
          margin-bottom: 10px;
        }

        .role-selector {
          grid-template-columns: 1fr;
          gap: 12px;
        }

        .role-btn {
          padding: 15px 10px;
        }

        .role-icon {
          font-size: 2rem;
        }

        .likert-scale {
          gap: 6px;
        }

        .likert-circle {
          width: 38px;
          height: 38px;
          font-size: 0.9rem;
        }

        .likert-label {
          font-size: 0.7rem;
        }

        .modal-content {
          padding: 15px;
          margin: 5px;
          border-radius: 15px;
        }

        .scores-grid {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .score-number {
          font-size: 2.8rem;
        }

        .couple-classification {
          font-size: 1.2rem;
        }

        .betrayal-index {
          font-size: 2rem;
        }

        .modal-actions {
          grid-template-columns: 1fr;
          gap: 10px;
        }

        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 10px;
        }

        .chart-bars {
          height: 120px;
        }

        .chart-bar {
          width: 30px;
        }
      }

      @media (min-width: 481px) and (max-width: 768px) {
        .container {
          padding: 10px;
        }

        .screen {
          padding: 25px;
          max-width: 600px;
        }

        h1 {
          font-size: 2rem;
        }

        .scores-grid {
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }
      }

      @media (min-width: 769px) {
        .container {
          padding: 20px;
        }

        .screen {
          padding: 30px;
          max-width: 700px;
        }

        h1 {
          font-size: 2.2rem;
        }

        .scores-grid {
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }
      }

      /* Mejoras para landscape en m√≥viles */
      @media (max-height: 500px) and (orientation: landscape) {
        .screen {
          margin: 5px 0;
          max-height: 90vh;
          overflow-y: auto;
        }

        h1 {
          font-size: 1.3rem;
          margin-bottom: 8px;
        }

        .role-selector {
          margin: 15px 0;
        }

        .role-btn {
          padding: 12px 8px;
        }

        .role-icon {
          font-size: 1.8rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Grid cibern√©tico -->
    <div class="cyber-grid"></div>

    <!-- Corazones 3D flotantes -->
    <div class="floating-hearts" id="floating-hearts"></div>

    <!-- Part√≠culas ne√≥n -->
    <div class="neon-particles" id="neon-particles"></div>

    <!-- Toggle de sonido -->
    <button class="sound-toggle" id="sound-toggle" onclick="toggleSound()">
      üîä
    </button>

    <!-- Modal de Edad -->
    <div class="modal active" id="age-modal">
      <div class="modal-content disclaimer-modal">
        <div class="disclaimer-title">üéÇ VERIFICACI√ìN DE EDAD</div>
        <div class="disclaimer-content">
          Para ofrecerte la mejor experiencia, necesitamos saber tu edad. Esto
          determinar√° el tipo de preguntas que recibir√°s.
        </div>
        <div style="margin: 20px 0">
          <input
            type="number"
            id="age-input"
            class="age-input"
            placeholder="Ingresa tu edad"
            min="13"
            max="99"
          />
        </div>
        <button
          class="btn"
          onclick="verifyAge()"
          id="age-continue-btn"
          disabled
        >
          CONTINUAR
        </button>
      </div>
    </div>

    <!-- Modal Disclaimer -->
    <div class="modal" id="disclaimer-modal">
      <div class="modal-content disclaimer-modal">
        <div class="disclaimer-title">‚ö†Ô∏è REAL TALK</div>
        <div class="disclaimer-content" id="disclaimer-text">
          Este test es para que reflexionen y se diviertan. No es medicina ni
          nada cient√≠fico. Si tienen problemas serios, hablen con un profesional
          de verdad.
        </div>
        <button class="btn" onclick="acceptDisclaimer()">
          ACEPTO Y CONTIN√öO
        </button>
      </div>
    </div>

    <div class="container">
      <!-- Pantalla de inicio -->
      <div class="screen" id="start-screen">
        <h1>üíò Test de Fuerza Relacional</h1>
        <p class="subtitle">
          Descubre qu√© tan real es tu conexi√≥n. 35 preguntas que van directo al
          grano. ¬øEst√°n listos para la verdad sin filtros? üå∂Ô∏è
        </p>

        <div class="role-selector">
          <div
            class="role-btn"
            data-role="novio"
            onclick="selectRole(this, 'novio')"
          >
            <span class="role-icon">üë®</span>
            <div>Comenzar como √âl</div>
          </div>
          <div
            class="role-btn"
            data-role="novia"
            onclick="selectRole(this, 'novia')"
          >
            <span class="role-icon">üë©</span>
            <div>Comenzar como Ella</div>
          </div>
        </div>

        <button class="btn" id="start-test" disabled onclick="startTest()">
          EMPEZAR
        </button>
      </div>

      <!-- Pantalla del test -->
      <div class="screen" id="test-screen">
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>

        <h2 id="test-title">Test - Parte 1</h2>
        <div id="questions-container"></div>
        <button
          class="btn"
          id="continue-test"
          disabled
          onclick="handleContinue()"
        >
          CONTINUAR
        </button>
      </div>

      <!-- Pantalla de transici√≥n -->
      <div class="screen transition-screen" id="transition-screen">
        <div class="transition-icon">üîÑ</div>
        <h2>¬°Listo!</h2>
        <p class="subtitle">
          Tu parte est√° completa. Ahora p√°sale el dispositivo a tu pareja para
          que haga la suya. ¬°No hagas trampa! üòè
        </p>
        <button class="btn" onclick="startPartnerTest()">CONTINUAR</button>
      </div>

      <!-- Pantalla de carga -->
      <div class="screen" id="loading-screen">
        <div style="text-align: center">
          <div
            style="
              font-size: 4rem;
              margin-bottom: 20px;
              animation: rotateGlow 1s ease infinite;
            "
          >
            üîÆ
          </div>
          <h2>Analizando datos...</h2>
          <p class="subtitle">
            Procesando toda la info. Preparando tu an√°lisis real, sin filtros...
          </p>
        </div>
      </div>
    </div>

    <!-- Modal de resultados -->
    <div class="modal" id="results-modal">
      <div class="modal-content">
        <button class="close-modal" onclick="closeModal()">&times;</button>
        <div id="results-content"></div>
        <div class="modal-actions">
          <button class="btn" onclick="restartTest()">OTRA VEZ</button>
          <button class="btn" onclick="shareResult()">COMPARTIR</button>
        </div>
      </div>
    </div>

    <script>
      // Variables globales
      let currentRole = "";
      let currentQuestionIndex = 0;
      let currentPartner = 1;
      let responses = {
        partner1: {},
        partner2: {},
      };
      let partner1Role = "";
      let partner2Role = "";
      let soundEnabled = true;
      let selectedQuestions = [];
      let userAge = null;
      let isAdult = false;

      // Audio Context y efectos de sonido
      let audioContext;
      let soundEffects = {};

      // Pool de preguntas NORMALES para menores de 18 (80 preguntas)
      const questionPoolNormal = [
        // Conexi√≥n Emocional Normal (20 preguntas)
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja realmente me entiende cuando le cuento mis cosas üíØ",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "A veces siento que estamos en diferentes ondas üòê",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Puedo contarle cualquier cosa sin que me juzgue üó£Ô∏è",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Siento que cada uno va por su lado üîÑ",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Cuando me pasa algo importante, es lo primero que pienso en contarle üì±",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja me hace sentir seguro/a emocionalmente üõ°Ô∏è",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "A veces siento que hablo con una pared cuando le cuento algo üß±",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Nos divertimos juntos como cuando empezamos üòÑ",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Siento que ya no tenemos cosas de qu√© hablar üò∂",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja es mi mejor amigo/a üë´",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Me siento solo/a aunque est√© con mi pareja üòî",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Compartimos los mismos valores importantes üéØ",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Siento que mi pareja no me conoce realmente üé≠",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Cuando estoy triste, mi pareja sabe c√≥mo animarme ü§ó",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "A menudo me siento incomprendido/a en esta relaci√≥n üòï",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja conoce mis secretos m√°s importantes üîê",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Prefiero estar solo/a que pasar tiempo con mi pareja üè†",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Nos re√≠mos juntos casi todos los d√≠as üòÇ",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Siento que fingimos ser felices la mayor parte del tiempo üé≠",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja me inspira a ser mejor persona üåü",
          reverse: false,
        },

        // Atracci√≥n y Romance Normal (20 preguntas)
        {
          category: "Atracci√≥n y Romance",
          text: "Todav√≠a me siento atra√≠do/a hacia mi pareja üî•",
          reverse: false,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "A veces me fijo en otras personas de manera rom√°ntica üí≠",
          reverse: true,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Mi pareja sigue siendo muy atractivo/a para m√≠ üí´",
          reverse: false,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Ya no siento esa chispa especial üíî",
          reverse: true,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Para m√≠ sigue siendo la persona m√°s linda del mundo üòç",
          reverse: false,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Me emociono cuando voy a ver a mi pareja ‚ú®",
          reverse: false,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "He perdido el inter√©s rom√°ntico üò¥",
          reverse: true,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Mi pareja a√∫n me pone nervioso/a de la buena manera ü¶ã",
          reverse: false,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Evito el contacto f√≠sico con mi pareja üö´",
          reverse: true,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Me gusta c√≥mo me ve mi pareja üëÄ",
          reverse: false,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Siento m√°s atracci√≥n por otras personas üë•",
          reverse: true,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "A√∫n me dan ganas de besarlo/a cuando lo/la veo üíã",
          reverse: false,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "La relaci√≥n se siente m√°s como amistad ü§ù",
          reverse: true,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Mi pareja me sigue pareciendo incre√≠ble üî•",
          reverse: false,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Ya no me emociona estar rom√°ntico/a con mi pareja üòë",
          reverse: true,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Cuando mi pareja me abraza, me siento completo/a ü§ó",
          reverse: false,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "He comparado a mi pareja con otras personas üìä",
          reverse: true,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "Mi pareja a√∫n me hace sonrojar üòä",
          reverse: false,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "A veces pienso en c√≥mo ser√≠a estar con alguien m√°s ü§î",
          reverse: true,
        },
        {
          category: "Atracci√≥n y Romance",
          text: "No puedo imaginarme besando a alguien m√°s üíã",
          reverse: false,
        },

        // Comunicaci√≥n Normal (20 preguntas)
        {
          category: "Comunicaci√≥n",
          text: "Podemos hablar de cualquier tema sin problemas üí¨",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n",
          text: "Evito las conversaciones dif√≠ciles üòµ",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n",
          text: "Conf√≠o en que mi pareja me dice la verdad ‚ú®",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n",
          text: "He ocultado cosas importantes √∫ltimamente ü§´",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n",
          text: "Cuando discutimos, terminamos arreglando las cosas ü§ù",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n",
          text: "Mi pareja realmente me escucha üëÇ",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n",
          text: "A menudo siento que no me presta atenci√≥n üì±",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n",
          text: "Podemos bromear y re√≠rnos juntos f√°cilmente üòÇ",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n",
          text: "Las discusiones se vuelven muy intensas üò§",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n",
          text: "Mi pareja respeta mis opiniones ü§î",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n",
          text: "Siento que tengo que cuidar lo que digo ü•ö",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n",
          text: "Nos comunicamos mejor ahora que al principio üìà",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n",
          text: "Prefiero contarle mis problemas a otras personas üë•",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n",
          text: "Mi pareja me hace sentir escuchado/a üíù",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n",
          text: "A menudo no nos entendemos ü§∑",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n",
          text: "Podemos hablar de nuestros sentimientos abiertamente ‚ù§Ô∏è",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n",
          text: "A veces finjo estar de acuerdo para evitar conflictos üé≠",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n",
          text: "Mi pareja nota cuando algo me molesta üîç",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n",
          text: "Hay temas que evitamos hablar ‚ùå",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n",
          text: "Nos entendemos sin necesidad de palabras ü§ê",
          reverse: false,
        },

        // Compromiso y Futuro Normal (20 preguntas)
        {
          category: "Compromiso y Futuro",
          text: "No me imagino mi futuro sin mi pareja üåü",
          reverse: false,
        },
        {
          category: "Compromiso y Futuro",
          text: "A veces pienso que podr√≠a ser m√°s feliz solo/a ü§î",
          reverse: true,
        },
        {
          category: "Compromiso y Futuro",
          text: "Estoy 100% comprometido/a con esta relaci√≥n üíØ",
          reverse: false,
        },
        {
          category: "Compromiso y Futuro",
          text: "He pensado en terminar la relaci√≥n üíî",
          reverse: true,
        },
        {
          category: "Compromiso y Futuro",
          text: "Mi pareja es mi prioridad n√∫mero uno ü•á",
          reverse: false,
        },
        {
          category: "Compromiso y Futuro",
          text: "A veces dudo si esta es la persona correcta ü§∑",
          reverse: true,
        },
        {
          category: "Compromiso y Futuro",
          text: "Defiendo a mi pareja cuando otros la critican üõ°Ô∏è",
          reverse: false,
        },
        {
          category: "Compromiso y Futuro",
          text: "He considerado estar con alguien m√°s üë•",
          reverse: true,
        },
        {
          category: "Compromiso y Futuro",
          text: "Mi pareja es irreemplazable para m√≠ üíé",
          reverse: false,
        },
        {
          category: "Compromiso y Futuro",
          text: "A veces fantaseo con terminar esto üö™",
          reverse: true,
        },
        {
          category: "Compromiso y Futuro",
          text: "Elijo a mi pareja todos los d√≠as üíï",
          reverse: false,
        },
        {
          category: "Compromiso y Futuro",
          text: "He perdido la ilusi√≥n en esta relaci√≥n üòî",
          reverse: true,
        },
        {
          category: "Compromiso y Futuro",
          text: "Mi pareja es mi persona favorita en el mundo üåç",
          reverse: false,
        },
        {
          category: "Compromiso y Futuro",
          text: "A veces siento que estoy perdiendo el tiempo ‚è∞",
          reverse: true,
        },
        {
          category: "Compromiso y Futuro",
          text: "Quiero envejecer junto a mi pareja üë¥üëµ",
          reverse: false,
        },
        {
          category: "Compromiso y Futuro",
          text: "He pensado en c√≥mo ser√≠a mi vida sin mi pareja ü§î",
          reverse: true,
        },
        {
          category: "Compromiso y Futuro",
          text: "Har√≠a cualquier cosa por salvar esta relaci√≥n üí™",
          reverse: false,
        },
        {
          category: "Compromiso y Futuro",
          text: "A veces me siento atrapado/a en esta relaci√≥n üîí",
          reverse: true,
        },
        {
          category: "Compromiso y Futuro",
          text: "Mi pareja y yo tenemos los mismos planes de vida üéØ",
          reverse: false,
        },
        {
          category: "Compromiso y Futuro",
          text: "He dudado si realmente amo a mi pareja ‚ùì",
          reverse: true,
        },
      ];

      // Pool de preguntas PICANTES para adultos +18 (120 preguntas simplificadas)
      const questionPoolAdult = [
        // Conexi√≥n Emocional (30 preguntas)
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja realmente me entiende cuando le cuento mis cosas üíØ",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Muchas veces siento que estamos en diferentes ondas üòê",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Puedo contarle cualquier cosa sin que me juzgue üó£Ô∏è",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Siento que cada uno va por su lado üîÑ",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Cuando me pasa algo bueno o malo, es lo primero que pienso en contarle üì±",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja me hace sentir seguro/a emocionalmente üõ°Ô∏è",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "A veces siento que hablo con una pared cuando le cuento algo üß±",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Nos divertimos juntos como cuando empezamos üòÑ",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Siento que ya no tenemos nada de qu√© hablar üò∂",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja es mi mejor amigo/a üë´",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Me siento solo/a aunque est√© con mi pareja üòî",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Compartimos los mismos valores importantes üéØ",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Siento que mi pareja no me conoce realmente üé≠",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Cuando estoy triste, mi pareja sabe c√≥mo consolarme ü§ó",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "A menudo me siento incomprendido/a en esta relaci√≥n üòï",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja conoce mis secretos m√°s profundos üîê",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Prefiero estar solo/a que pasar tiempo con mi pareja üè†",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Nos re√≠mos juntos todos los d√≠as üòÇ",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Siento que fingimos ser felices la mayor parte del tiempo üé≠",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja me inspira a ser mejor persona üåü",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Ya no compartimos sue√±os o planes juntos üí≠",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Me siento completamente c√≥modo/a siendo yo mismo/a con mi pareja üòå",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Evito mostrar mis verdaderas emociones a mi pareja üò∂",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja me hace sentir especial y √∫nico/a ‚ú®",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Siento que somos como extra√±os viviendo juntos üë•",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Tenemos tradiciones y rituales que nos unen üéä",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Ya no me importa lo que piense mi pareja sobre m√≠ ü§∑",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Mi pareja es la primera persona que quiero ver cuando llego a casa üè°",
          reverse: false,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Me aburro cuando estamos juntos sin hacer nada üò¥",
          reverse: true,
        },
        {
          category: "Conexi√≥n Emocional",
          text: "Podemos estar en silencio y sentirme completamente conectado/a ü§ê",
          reverse: false,
        },

        // Deseo y Atracci√≥n (30 preguntas) - M√ÅS CALIENTES
        {
          category: "Deseo y Atracci√≥n",
          text: "Todav√≠a me atrae f√≠sicamente como al principio üî•",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "A veces fantaseo con otras personas üí≠",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "La intimidad con mi pareja me deja satisfecho/a üí´",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Ya no siento esa chispa rom√°ntica üíî",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Para m√≠ sigue siendo la persona m√°s atractiva del mundo üòç",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He pensado en alguien m√°s durante la intimidad con mi pareja üôà",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Mi pareja a√∫n me excita solo con mirarme üëÄ",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He comparado f√≠sicamente a mi pareja con otras personas üìè",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "A√∫n tengo ganas de tocar a mi pareja cuando la veo ü§≤",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Me siento m√°s atra√≠do/a hacia personas en redes sociales que hacia mi pareja üì±",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Mi pareja me sigue poniendo nervioso/a cuando me toca ü¶ã",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He sentido deseo sexual por alguien que conozco en persona üî•",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "La pasi√≥n entre nosotros sigue siendo intensa üå∂Ô∏è",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He fantaseado con actores/actrices o influencers üé¨",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Mi pareja conoce exactamente c√≥mo satisfacerme üíØ",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He mirado con deseo a otras personas cuando estoy con mi pareja üëÅÔ∏è",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Siento mariposas en el est√≥mago cuando mi pareja me besa üíã",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He pensado en experiencias sexuales con alguien espec√≠fico que no es mi pareja ü§´",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Mi pareja sigue siendo mi fantas√≠a sexual principal üî•",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He sentido atracci√≥n f√≠sica fuerte por un amigo/a üë•",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Me emociono sexualmente pensando en mi pareja ü§§",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He coqueteado con alguien m√°s aunque sea 'jugando' üòâ",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Mi pareja me enciende con solo susurrarme al o√≠do üó£Ô∏è",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He sentido que alguien m√°s me entiende mejor sexualmente üí≠",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "La qu√≠mica sexual con mi pareja sigue siendo explosiva üí•",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He tenido sue√±os er√≥ticos con personas que no son mi pareja üò¥",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "Mi pareja sabe exactamente c√≥mo prenderme üî•",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He sentido ganas de experimentar cosas nuevas con alguien m√°s üÜï",
          reverse: true,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "No puedo mantener las manos quietas cuando estoy cerca de mi pareja üëê",
          reverse: false,
        },
        {
          category: "Deseo y Atracci√≥n",
          text: "He sentido curiosidad sexual por personas del trabajo/estudio üè¢",
          reverse: true,
        },

        // Comunicaci√≥n y Honestidad (30 preguntas)
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Podemos hablar de cualquier tema sin dramas üí¨",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Evito las conversaciones dif√≠ciles porque siempre terminan mal üòµ",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Conf√≠o en que mi pareja siempre me dice la verdad ‚ú®",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He ocultado cosas importantes √∫ltimamente ü§´",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Cuando discutimos, terminamos arreglando las cosas bien ü§ù",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He mentido sobre con qui√©n estuve o d√≥nde fui ü§•",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Mi pareja y yo hablamos de nuestros miedos sin juzgarnos üò∞",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He borrado mensajes para que mi pareja no los vea üì±",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Podemos resolver cualquier conflicto hablando üó£Ô∏è",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He guardado secretos sobre mis sentimientos hacia otras personas ü§ê",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Mi pareja conoce mis inseguridades m√°s profundas üíî",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He evitado contar detalles sobre salidas con amigos üç∫",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Nos contamos todo lo que nos pasa en el d√≠a üìÖ",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He fingido estar bien cuando en realidad estaba molesto/a üò§",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Mi pareja me escucha sin interrumpir cuando necesito desahogarme üëÇ",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He ocultado conversaciones con personas del pasado üìû",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Podemos bromear sobre temas delicados sin lastimarnos üòÑ",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He evitado mencionar a ciertas personas para no crear problemas üö´",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Mi pareja respeta cuando necesito espacio para procesar las cosas üåå",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He cambiado la verdad para evitar que mi pareja se moleste üîÑ",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Nos comunicamos mejor ahora que cuando empezamos üìà",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He tenido pensamientos que nunca le confesar√≠a a mi pareja üß†",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Mi pareja nota cuando algo me molesta aunque no lo diga üîç",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He usado mi tel√©fono de manera que mi pareja no pueda ver üì≤",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Podemos hablar de nuestro futuro juntos sin miedo üîÆ",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He evitado responder preguntas directas de mi pareja ‚ùì",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Mi pareja me hace sentir seguro/a para expresar mis opiniones üõ°Ô∏è",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He actuado como si no hubiera pasado nada cuando s√≠ pas√≥ algo üé≠",
          reverse: true,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "Tenemos conversaciones profundas regularmente üåä",
          reverse: false,
        },
        {
          category: "Comunicaci√≥n y Honestidad",
          text: "He mantenido contacto secreto con alguien del pasado üìß",
          reverse: true,
        },

        // Tentaci√≥n y Deseo Externo (30 preguntas) - S√öPER CALIENTES
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He sentido atracci√≥n rom√°ntica fuerte por alguien que no es mi pareja üíò",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "No me imagino un futuro rom√°ntico con nadie m√°s üåü",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He buscado conexi√≥n emocional profunda en otras personas üîç",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "Estoy 100% comprometido/a emocionalmente con esta relaci√≥n üíØ",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "A veces pienso que podr√≠a ser m√°s feliz con otra persona espec√≠fica ü§î",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He tenido fantas√≠as rom√°nticas detalladas con alguien m√°s üí≠",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "Mi pareja es irreemplazable en todos los aspectos üíé",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He sentido mariposas por alguien que no es mi pareja ü¶ã",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "Defiendo a mi pareja cuando otros la critican o insin√∫an cosas üõ°Ô∏è",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He imaginado c√≥mo ser√≠a besar a alguien espec√≠fico üíã",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He pensado seriamente en c√≥mo ser√≠a estar √≠ntimamente con otra persona üî•",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "Mi pareja satisface todos mis deseos emocionales y f√≠sicos üíï",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He sentido conexi√≥n especial con alguien m√°s que me preocupa üö®",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "Elijo activamente a mi pareja sobre cualquier otra opci√≥n üí™",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He tenido conversaciones √≠ntimas que cruzaron la l√≠nea con alguien m√°s üí¨",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He fantaseado con terminar mi relaci√≥n para estar con alguien espec√≠fico üíî",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "Mi pareja es mi √∫nica opci√≥n rom√°ntica real y verdadera üéØ",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He sentido tentaci√≥n real de hacer algo con alguien m√°s üòà",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He considerado seriamente si estar√≠a mejor con alguien espec√≠fico que conozco ü§∑",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "Mi coraz√≥n le pertenece completamente a mi pareja actual üíñ",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He sentido que alguien m√°s me entiende mejor que mi pareja üß†",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He tenido sue√±os rom√°nticos recurrentes con la misma persona üò¥",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "No hay nadie en el mundo que me atraiga m√°s que mi pareja üåç",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He pensado en c√≥mo ser√≠a la vida diaria con alguien espec√≠fico üè†",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He comparado emocionalmente a mi pareja con alguien m√°s y mi pareja perdi√≥ üìä",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "Mi pareja es mi alma gemela y no necesito buscar en otro lado üë´",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He sentido que tengo m√°s qu√≠mica con alguien m√°s ‚ö°",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He tenido momentos donde casi cruzo la l√≠nea con alguien m√°s üö´",
          reverse: true,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "Mi compromiso con mi pareja es inquebrantable sin importar qui√©n aparezca üîí",
          reverse: false,
        },
        {
          category: "Tentaci√≥n y Deseo Externo",
          text: "He sentido que alguien m√°s podr√≠a hacerme m√°s feliz en general üòä",
          reverse: true,
        },
      ];

      // Funci√≥n para obtener el pool correcto seg√∫n la edad
      function getQuestionPool() {
        if (isAdult) {
          return questionPoolAdult; // Para +18 (contenido picante)
        } else {
          return questionPoolNormal; // Para menores (contenido apropiado)
        }
      }

      // Inicializaci√≥n
      document.addEventListener("DOMContentLoaded", function () {
        initializeAudio();
        setupEventListeners();
        create3DHearts();
        createNeonParticles();
        setupAgeInput();
        playStartSound();
      });

      function setupAgeInput() {
        const ageInput = document.getElementById("age-input");
        const continueBtn = document.getElementById("age-continue-btn");

        ageInput.addEventListener("input", function () {
          const age = parseInt(this.value);
          continueBtn.disabled = !age || age < 13 || age > 99;
        });

        ageInput.addEventListener("keypress", function (e) {
          if (e.key === "Enter" && !continueBtn.disabled) {
            verifyAge();
          }
        });
      }

      function verifyAge() {
        const age = parseInt(document.getElementById("age-input").value);
        if (age < 13 || age > 99) {
          alert("Por favor ingresa una edad v√°lida");
          return;
        }

        userAge = age;
        isAdult = age >= 18;

        playSound("success");
        document.getElementById("age-modal").classList.remove("active");

        // Actualizar disclaimer seg√∫n la edad
        const disclaimerText = document.getElementById("disclaimer-text");
        if (isAdult) {
          disclaimerText.innerHTML = `
                <strong>üîû CONTENIDO PARA ADULTOS:</strong><br>
                Este test contiene preguntas con contenido sugerente y doble sentido. Es solo para reflexi√≥n y diversi√≥n. 
                No es un diagn√≥stico m√©dico. Si tienen problemas reales de pareja, consulten con un profesional.
                <br><br>
                <strong>Edad detectada: ${userAge} a√±os</strong> - Acceso a preguntas para adultos ‚úÖ
            `;
        } else {
          disclaimerText.innerHTML = `
                <strong>üë∂ VERSI√ìN JOVEN:</strong><br>
                Este test contiene preguntas apropiadas para tu edad. Es para reflexi√≥n y diversi√≥n. 
                No es un diagn√≥stico m√©dico. Si tienen problemas, hablen con un adulto de confianza o profesional.
                <br><br>
                <strong>Edad detectada: ${userAge} a√±os</strong> - Versi√≥n apropiada para menores ‚úÖ
            `;
        }

        setTimeout(() => {
          document.getElementById("disclaimer-modal").classList.add("active");
        }, 500);
      }

      function acceptDisclaimer() {
        playSound("success");
        document.getElementById("disclaimer-modal").classList.remove("active");
        document.getElementById("start-screen").classList.add("active");

        // Limpiar cualquier selecci√≥n previa para empezar fresco
        selectedQuestions = [];
        responses = { partner1: {}, partner2: {} };

        // Actualizar subt√≠tulo seg√∫n la edad
        const subtitle = document.querySelector(".subtitle");
        if (isAdult) {
          subtitle.textContent =
            "üîû Descubre qu√© tan real es tu conexi√≥n. 35 preguntas que van directo al grano sin filtros. ¬øEst√°n listos para la verdad? üå∂Ô∏è";
        } else {
          subtitle.textContent =
            "Descubre qu√© tan fuerte es tu conexi√≥n. 35 preguntas honestas sobre tu relaci√≥n. ¬øEst√°n listos para conocerse mejor? üíï";
        }
      }

      function initializeAudio() {
        try {
          audioContext = new (window.AudioContext ||
            window.webkitAudioContext)();
          createSoundEffects();
        } catch (e) {
          console.log("Audio no disponible");
          soundEnabled = false;
        }
      }

      function createSoundEffects() {
        if (!audioContext) return;

        soundEffects.click = createSynth(400, 0.1, "square");
        soundEffects.success = createSynth(600, 0.3, "sawtooth");
        soundEffects.progress = createSynth(800, 0.2, "triangle");
        soundEffects.celebration = createBassline([220, 330, 440, 550], 0.8);
      }

      function createSynth(frequency, duration, waveType = "sine") {
        return () => {
          if (!soundEnabled || !audioContext) return;

          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();
          const filter = audioContext.createBiquadFilter();

          oscillator.connect(filter);
          filter.connect(gainNode);
          gainNode.connect(audioContext.destination);

          oscillator.frequency.value = frequency;
          oscillator.type = waveType;
          filter.type = "lowpass";
          filter.frequency.value = frequency * 2;

          gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(
            0.01,
            audioContext.currentTime + duration
          );

          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + duration);
        };
      }

      function createBassline(frequencies, duration) {
        return () => {
          if (!soundEnabled || !audioContext) return;

          frequencies.forEach((freq, index) => {
            setTimeout(() => {
              createSynth(freq, duration / frequencies.length, "square")();
            }, (index * (duration * 1000)) / frequencies.length);
          });
        };
      }

      function create3DHearts() {
        const container = document.getElementById("floating-hearts");
        const heartClasses = ["", "cyan", "purple", "orange"];

        for (let i = 0; i < 25; i++) {
          const heart = document.createElement("div");
          heart.className = `heart-3d ${
            heartClasses[Math.floor(Math.random() * heartClasses.length)]
          }`;
          heart.style.left = Math.random() * 100 + "%";
          heart.style.animationDelay = Math.random() * 15 + "s";
          heart.style.animationDuration = Math.random() * 8 + 12 + "s";
          container.appendChild(heart);
        }
      }

      function createNeonParticles() {
        const container = document.getElementById("neon-particles");

        for (let i = 0; i < 30; i++) {
          const particle = document.createElement("div");
          particle.className = "particle";
          particle.style.left = Math.random() * 100 + "%";
          particle.style.top = Math.random() * 100 + "%";
          particle.style.animationDelay = Math.random() * 8 + "s";

          const colors = ["#00ffff", "#ff1493", "#9932cc", "#ff6b35"];
          const color = colors[Math.floor(Math.random() * colors.length)];
          particle.style.background = color;
          particle.style.boxShadow = `0 0 8px ${color}`;

          container.appendChild(particle);
        }
      }

      function selectRandomQuestions() {
        // Usar la funci√≥n que determina el pool correcto seg√∫n la edad
        const currentPool = getQuestionPool();

        // Crear grupos de preguntas por categor√≠a
        const categories = {};
        currentPool.forEach((question) => {
          if (!categories[question.category]) {
            categories[question.category] = [];
          }
          categories[question.category].push(question);
        });

        // Limpiar preguntas anteriores
        selectedQuestions = [];

        // Seleccionar 8-9 preguntas de cada categor√≠a aleatoriamente usando timestamp para m√°s randomness
        const timestamp = Date.now();
        const questionsPerCategory = [9, 9, 9, 8]; // Total = 35 preguntas
        let categoryIndex = 0;

        Object.keys(categories).forEach((category) => {
          const categoryQuestions = [...categories[category]]; // Crear copia
          const questionsToSelect = questionsPerCategory[categoryIndex] || 8;

          // Mezclar usando algoritmo Fisher-Yates con timestamp
          for (let i = categoryQuestions.length - 1; i > 0; i--) {
            const randomSeed =
              (timestamp +
                categoryIndex +
                i +
                currentPartner +
                Math.random() * 1000) %
              categoryQuestions.length;
            const j = Math.floor(randomSeed);
            [categoryQuestions[i], categoryQuestions[j]] = [
              categoryQuestions[j],
              categoryQuestions[i],
            ];
          }

          // Tomar las preguntas despu√©s del shuffle
          selectedQuestions.push(
            ...categoryQuestions.slice(0, questionsToSelect)
          );
          categoryIndex++;
        });

        // Mezclar el orden final de todas las preguntas con m√°s randomness
        for (let i = selectedQuestions.length - 1; i > 0; i--) {
          const randomSeed =
            (timestamp + currentPartner + Math.random() * 1000 + i) %
            selectedQuestions.length;
          const j = Math.floor(randomSeed);
          [selectedQuestions[i], selectedQuestions[j]] = [
            selectedQuestions[j],
            selectedQuestions[i],
          ];
        }

        const ageText = isAdult ? "üîû PICANTES" : "üë∂ APROPIADAS";
        console.log(
          `üî• ${selectedQuestions.length} preguntas ${ageText} generadas para partner ${currentPartner}`
        );
      }

      function playSound(soundName) {
        if (soundEffects[soundName]) {
          soundEffects[soundName]();
        }
      }

      function playStartSound() {
        playSound("success");
      }

      function toggleSound() {
        soundEnabled = !soundEnabled;
        const toggle = document.getElementById("sound-toggle");
        toggle.textContent = soundEnabled ? "üîä" : "üîá";
        playSound("click");
      }

      function setupEventListeners() {
        document.addEventListener("change", function (e) {
          if (e.target.type === "radio") {
            playSound("click");
            updateProgress();
            checkCompletion();

            const circle = e.target.nextElementSibling;
            circle.style.animation = "none";
            setTimeout(() => {
              circle.style.animation = "checkGlow 0.6s ease";
            }, 10);
          }
        });
      }

      function selectRole(element, role) {
        playSound("click");
        document
          .querySelectorAll(".role-btn")
          .forEach((btn) => btn.classList.remove("selected"));
        element.classList.add("selected");
        currentRole = role;
        document.getElementById("start-test").disabled = false;
      }

      function startTest() {
        playSound("success");
        selectRandomQuestions(); // Generar preguntas aleatorias
        partner1Role = currentRole;
        currentPartner = 1;
        currentQuestionIndex = 0;
        showScreen("test-screen");
        updateTestTitle();
        renderQuestions();
        updateProgress();
      }

      function startPartnerTest() {
        playSound("success");
        partner2Role = currentRole === "novio" ? "novia" : "novio";
        currentRole = partner2Role;
        currentPartner = 2;
        currentQuestionIndex = 0;

        // Generar nuevas preguntas para el segundo partner
        selectRandomQuestions();

        showScreen("test-screen");
        updateTestTitle();
        renderQuestions();
        updateProgress();
      }

      function updateTestTitle() {
        const title = document.getElementById("test-title");
        const roleText = currentRole === "novio" ? "√âL üë®" : "ELLA üë©";
        title.textContent = `TEST - ${roleText} (PARTE ${currentPartner}/2)`;
      }

      function renderQuestions() {
        const container = document.getElementById("questions-container");
        container.innerHTML = "";

        selectedQuestions.forEach((question, index) => {
          const questionDiv = document.createElement("div");
          questionDiv.className = "question";
          questionDiv.style.animationDelay = `${index * 0.1}s`;

          questionDiv.innerHTML = `
                <h3>${index + 1}. ${question.text}</h3>
                <div class="likert-scale">
                    ${[1, 2, 3, 4, 5]
                      .map(
                        (value) => `
                        <label class="likert-option">
                            <input type="radio" name="q${index}" value="${value}">
                            <div class="likert-circle">${value}</div>
                            <div class="likert-label">${getLikertLabel(
                              value
                            )}</div>
                        </label>
                    `
                      )
                      .join("")}
                </div>
            `;

          container.appendChild(questionDiv);
        });
      }

      function getLikertLabel(value) {
        const labels = {
          1: "Para nada",
          2: "Poco",
          3: "Normal",
          4: "Bastante",
          5: "Totalmente",
        };
        return labels[value];
      }

      function updateProgress() {
        const answeredQuestions = document.querySelectorAll(
          'input[type="radio"]:checked'
        ).length;
        const progress = (answeredQuestions / selectedQuestions.length) * 100;
        document.getElementById("progress-fill").style.width = `${progress}%`;

        if (answeredQuestions > 0 && answeredQuestions % 5 === 0) {
          playSound("progress");
        }
      }

      function checkCompletion() {
        const answeredQuestions = document.querySelectorAll(
          'input[type="radio"]:checked'
        ).length;
        const continueBtn = document.getElementById("continue-test");
        const wasDisabled = continueBtn.disabled;
        continueBtn.disabled = answeredQuestions < selectedQuestions.length;

        if (wasDisabled && !continueBtn.disabled) {
          playSound("success");
        }
      }

      function handleContinue() {
        playSound("success");
        saveResponses();

        if (currentPartner === 1) {
          showScreen("transition-screen");
        } else {
          showScreen("loading-screen");
          setTimeout(() => {
            calculateAndShowResults();
          }, 3000);
        }
      }

      function saveResponses() {
        const partnerKey = `partner${currentPartner}`;
        responses[partnerKey] = {};

        selectedQuestions.forEach((question, index) => {
          const selectedInput = document.querySelector(
            `input[name="q${index}"]:checked`
          );
          if (selectedInput) {
            let value = parseInt(selectedInput.value);
            if (question.reverse) {
              value = 6 - value;
            }
            responses[partnerKey][index] = {
              value: value,
              category: question.category,
              originalQuestion: question.text,
            };
          }
        });
      }

      function calculateAndShowResults() {
        const results = {
          partner1: calculateDetailedScore(responses.partner1),
          partner2: calculateDetailedScore(responses.partner2),
        };

        const coupleResult = calculateCoupleResult(
          results.partner1.score,
          results.partner2.score
        );
        showProfessionalResults(results, coupleResult);
        playSound("celebration");
      }

      function calculateDetailedScore(partnerResponses) {
        let totalScore = 0;
        let count = 0;
        let categoryScores = {};

        // Inicializar categor√≠as seg√∫n la edad
        const categories = isAdult
          ? [
              "Conexi√≥n Emocional",
              "Deseo y Atracci√≥n",
              "Comunicaci√≥n y Honestidad",
              "Tentaci√≥n y Deseo Externo",
            ]
          : [
              "Conexi√≥n Emocional",
              "Atracci√≥n y Romance",
              "Comunicaci√≥n",
              "Compromiso y Futuro",
            ];

        categories.forEach((cat) => {
          categoryScores[cat] = { total: 0, count: 0 };
        });

        // Calcular puntajes por categor√≠a
        for (let questionIndex in partnerResponses) {
          const response = partnerResponses[questionIndex];
          totalScore += response.value;
          count++;

          // Acumular por categor√≠a
          if (categoryScores[response.category]) {
            categoryScores[response.category].total += response.value;
            categoryScores[response.category].count++;
          }
        }

        // Calcular promedios
        const averageScore = totalScore / count;
        const normalizedScore = Math.round(((averageScore - 1) / 4) * 100);

        // Calcular puntajes por categor√≠a
        const categoryResults = {};
        Object.keys(categoryScores).forEach((category) => {
          if (categoryScores[category].count > 0) {
            const catAvg =
              categoryScores[category].total / categoryScores[category].count;
            categoryResults[category] = Math.round(((catAvg - 1) / 4) * 100);
          }
        });

        return {
          score: normalizedScore,
          level: getRiskLevel(normalizedScore),
          analysis: getAnalysisText(normalizedScore),
          categoryScores: categoryResults,
          totalQuestions: count,
          averageResponse: averageScore.toFixed(2),
        };
      }

      function getRiskLevel(score) {
        if (score <= 35) return { text: "BAJO RIESGO üíö", class: "risk-low" };
        if (score <= 70)
          return { text: "RIESGO MEDIO üü°", class: "risk-medium" };
        return { text: "RIESGO ALTO üî¥", class: "risk-high" };
      }

      function getAnalysisText(score) {
        if (score <= 35) {
          return "¬°DAMN BRO! üî• Tu mente est√° s√∫per limpia y conectada. Tus pensamientos est√°n 100% con tu pareja. Esto es lo que llamo fidelidad mental real, no hay nada que te 'distraiga' üíØüß†";
        } else if (score <= 70) {
          return "Ey, tu mente est√° 'jugando' un poco por ah√≠ üòè Hay algunas fantas√≠as y pensamientos que est√°n 'calentando' otras √°reas. Nada grave, pero hay que estar consciente de d√≥nde va la mente üß†üå∂Ô∏è";
        } else {
          return "Bro... tu mente est√° 'corriendo' hacia otros lados üèÉ‚Äç‚ôÄÔ∏èüî• Hay muchas fantas√≠as y deseos que est√°n 'explorando' territorios prohibidos. Es momento de decidir qu√© quieres realmente ü§îüí≠";
        }
      }

      function calculateCoupleResult(score1, score2) {
        const betrayalIndex = Math.round((score1 + score2) / 2);

        let classification, icon, message;

        if (score1 <= 35 && score2 <= 35) {
          classification = "üî• PAREJA MENTALMENTE FIEL";
          icon = "üî•";
          message =
            "¬°YO! üíØ Sus mentes est√°n s√∫per conectadas y limpias. No hay fantas√≠as raras ni pensamientos 'sucios' hacia otros. Esto es fidelidad mental REAL, bro üß†üíò";
        } else if (score1 > 70 && score2 > 70) {
          classification = "üö® MENTES EN PELIGRO";
          icon = "üö®";
          message =
            "Real talk... üò∞ Ambos tienen la mente 'corriendo' hacia otros lados. Hay muchas fantas√≠as y deseos 'calientes' que no incluyen a su pareja. Esto est√° peligroso üå∂Ô∏èüí≠";
        } else {
          classification = "‚ö†Ô∏è UNO EST√Å 'CALIENTE' POR OTROS";
          icon = "‚ö†Ô∏è";
          message =
            "Ojo aqu√≠... ü§® Uno de ustedes tiene la mente m√°s 'sucia' que el otro. Hay fantas√≠as y deseos que est√°n 'explorando' territorios prohibidos. Hay que hablar esto üó£Ô∏èüî•";
        }

        return { classification, icon, message, betrayalIndex };
      }

      function showProfessionalResults(results, coupleResult) {
        const modal = document.getElementById("results-modal");
        const content = document.getElementById("results-content");

        const partner1RoleText = partner1Role === "novio" ? "√âL üë®" : "ELLA üë©";
        const partner2RoleText = partner2Role === "novio" ? "√âL üë®" : "ELLA üë©";

        content.innerHTML = `
            <div class="result-header">
                <div class="result-icon">${coupleResult.icon}</div>
                <h2>AN√ÅLISIS COMPLETO DE RESULTADOS</h2>
            </div>

            <!-- Comparaci√≥n Visual -->
            <div class="comparison-chart">
                <div class="chart-title">Comparaci√≥n de Scores</div>
                <div class="chart-bars">
                    <div>
                        <div class="chart-bar" data-value="${
                          results.partner1.score
                        }" style="height: ${
          results.partner1.score * 1.5
        }px;"></div>
                        <div class="chart-label">${partner1RoleText}</div>
                    </div>
                    <div>
                        <div class="chart-bar" data-value="${
                          results.partner2.score
                        }" style="height: ${
          results.partner2.score * 1.5
        }px;"></div>
                        <div class="chart-label">${partner2RoleText}</div>
                    </div>
                </div>
            </div>

            <!-- Estad√≠sticas Generales -->
            <div class="stats-container">
                <div class="chart-title">Estad√≠sticas del Test</div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">${
                          selectedQuestions.length
                        }</div>
                        <div class="stat-label">${
                          isAdult
                            ? "Preguntas Picantes"
                            : "Preguntas Apropiadas"
                        }</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${Math.round(
                          (results.partner1.score + results.partner2.score) / 2
                        )}%</div>
                        <div class="stat-label">Promedio</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${Math.abs(
                          results.partner1.score - results.partner2.score
                        )}</div>
                        <div class="stat-label">Diferencia</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${
                          coupleResult.betrayalIndex
                        }%</div>
                        <div class="stat-label">${
                          isAdult ? "√çndice Mental" : "√çndice Emocional"
                        }</div>
                    </div>
                </div>
            </div>

            <div class="scores-grid">
                <div class="score-display">
                    <h3>${partner1RoleText}</h3>
                    <div class="score-number">${results.partner1.score}</div>
                    <div class="score-label">DE 100 PUNTOS</div>
                    <div class="risk-level ${results.partner1.level.class}">${
          results.partner1.level.text
        }</div>
                    
                    <!-- An√°lisis por categor√≠as -->
                    <div class="category-breakdown">
                        <h4 style="color: #00ffff; margin-bottom: 15px; font-family: 'Orbitron', monospace;">AN√ÅLISIS POR CATEGOR√çAS</h4>
                        ${Object.keys(results.partner1.categoryScores)
                          .map(
                            (category) => `
                            <div class="category-item">
                                <div class="category-header">
                                    <span class="category-name">${category}</span>
                                    <span class="category-score">${results.partner1.categoryScores[category]}%</span>
                                </div>
                                <div class="category-bar">
                                    <div class="category-fill" style="width: ${results.partner1.categoryScores[category]}%"></div>
                                </div>
                            </div>
                        `
                          )
                          .join("")}
                    </div>
                    
                    <p class="analysis-text">${results.partner1.analysis}</p>
                </div>
                
                <div class="score-display">
                    <h3>${partner2RoleText}</h3>
                    <div class="score-number">${results.partner2.score}</div>
                    <div class="score-label">DE 100 PUNTOS</div>
                    <div class="risk-level ${results.partner2.level.class}">${
          results.partner2.level.text
        }</div>
                    
                    <!-- An√°lisis por categor√≠as -->
                    <div class="category-breakdown">
                        <h4 style="color: #00ffff; margin-bottom: 15px; font-family: 'Orbitron', monospace;">AN√ÅLISIS POR CATEGOR√çAS</h4>
                        ${Object.keys(results.partner2.categoryScores)
                          .map(
                            (category) => `
                            <div class="category-item">
                                <div class="category-header">
                                    <span class="category-name">${category}</span>
                                    <span class="category-score">${results.partner2.categoryScores[category]}%</span>
                                </div>
                                <div class="category-bar">
                                    <div class="category-fill" style="width: ${results.partner2.categoryScores[category]}%"></div>
                                </div>
                            </div>
                        `
                          )
                          .join("")}
                    </div>
                    
                    <p class="analysis-text">${results.partner2.analysis}</p>
                </div>
            </div>

            <div class="couple-result">
                <h3>üíò RESULTADO DE PAREJA</h3>
                <div class="couple-classification">${
                  coupleResult.classification
                }</div>
                <div style="font-size: 1.1rem; font-weight: 600; margin: 12px 0; color: #ffffff; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);">${
                  isAdult
                    ? "√çNDICE DE INFIDELIDAD MENTAL"
                    : "√çNDICE DE DESCONEXI√ìN EMOCIONAL"
                }</div>
                <div class="betrayal-index">${coupleResult.betrayalIndex}%</div>
                <p class="analysis-text">${coupleResult.message}</p>
                
                <!-- Recomendaciones -->
                <div style="margin-top: 20px; padding: 15px; background: rgba(0, 0, 0, 0.6); border-radius: 12px; border-left: 4px solid #ff1493;">
                    <h4 style="color: #ff1493; margin-bottom: 10px;">üéØ RECOMENDACIONES</h4>
                    <p style="color: #ffffff; font-size: 0.9rem; line-height: 1.4;">
                        ${getRecommendations(
                          results.partner1.score,
                          results.partner2.score
                        )}
                    </p>
                </div>
            </div>
        `;

        modal.classList.add("active");
      }

      function getRecommendations(score1, score2) {
        if (score1 <= 35 && score2 <= 35) {
          return "¬°Sus mentes est√°n s√∫per limpias! üß†‚ú® Sigan as√≠, no se dejen 'calentar' por otros. Su fidelidad mental es REAL. ¬°A seguir siendo fieles en pensamientos y acciones! üí™üî•";
        } else if (score1 > 70 || score2 > 70) {
          return "Ojo... hay mentes 'calientes' aqu√≠ üå∂Ô∏èüß† Es momento de hablar sobre esas fantas√≠as y deseos. Decidan si quieren 'enfriar' esos pensamientos o ser honestos sobre lo que sienten üí≠üî•";
        } else {
          return "Hay pensamientos que est√°n 'jugando' por ah√≠ üòè Nada grave pero hay que estar conscientes. Hablen sobre sus fantas√≠as y mantengan la mente enfocada en lo que realmente quieren üéØüíï";
        }
      }

      function closeModal() {
        playSound("click");
        document.getElementById("results-modal").classList.remove("active");
      }

      function restartTest() {
        playSound("success");

        // Resetear todas las variables
        currentRole = "";
        currentQuestionIndex = 0;
        currentPartner = 1;
        responses = { partner1: {}, partner2: {} };
        partner1Role = "";
        partner2Role = "";
        selectedQuestions = []; // Limpiar preguntas para que se generen nuevas
        userAge = null;
        isAdult = false;

        document
          .querySelectorAll(".role-btn")
          .forEach((btn) => btn.classList.remove("selected"));
        document.getElementById("start-test").disabled = true;
        document.getElementById("age-input").value = "";
        document.getElementById("age-continue-btn").disabled = true;

        closeModal();
        // Volver al modal de edad
        document.getElementById("age-modal").classList.add("active");
      }

      function shareResult() {
        playSound("click");

        const shareText = `¬°Acabo de hacer el Test de Fuerza Relacional! üíòüî•
        
Los resultados est√°n locos... ¬øTe atreves a hacerlo con tu pareja? 

#TestDePareja #RelationshipGoals #RealTalk`;

        if (navigator.share) {
          navigator.share({
            title: "üíò Test de Fuerza Relacional",
            text: shareText,
            url: window.location.href,
          });
        } else {
          navigator.clipboard
            .writeText(shareText + "\n\n" + window.location.href)
            .then(() => {
              alert("¬°Texto copiado! Ahora p√©galo donde quieras üìãüí•");
            })
            .catch(() => {
              alert("¬°Funci√≥n de compartir lista! üì±üí•");
            });
        }
      }

      function showScreen(screenId) {
        document.querySelectorAll(".screen").forEach((screen) => {
          screen.classList.remove("active");
        });

        setTimeout(() => {
          document.getElementById(screenId).classList.add("active");
        }, 100);
      }
    </script>
        <script src="security.js"></script>
  </body>
</html>

  

