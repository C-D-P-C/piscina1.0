<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      MacPollo Analytics - Sistema de An√°lisis de Costos de Limpieza
    </title>

    <!-- Fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- Favicon -->
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üêî</text></svg>"
    />

    <style>
      /* Variables CSS Profesionales */
      :root {
        /* Paleta de colores MacPollo */
        --primary-50: #fff7ed;
        --primary-100: #ffedd5;
        --primary-200: #fed7aa;
        --primary-300: #fdba74;
        --primary-400: #fb923c;
        --primary-500: #f97316;
        --primary-600: #ea580c;
        --primary-700: #c2410c;
        --primary-800: #9a3412;
        --primary-900: #7c2d12;

        --accent-50: #fef3c7;
        --accent-100: #fef3c7;
        --accent-200: #fde68a;
        --accent-300: #fcd34d;
        --accent-400: #fbbf24;
        --accent-500: #f59e0b;
        --accent-600: #d97706;
        --accent-700: #b45309;
        --accent-800: #92400e;
        --accent-900: #78350f;

        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-300: #d1d5db;
        --gray-400: #9ca3af;
        --gray-500: #6b7280;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --gray-900: #111827;

        --success-50: #ecfdf5;
        --success-500: #10b981;
        --success-600: #059669;

        --warning-50: #fffbeb;
        --warning-500: #f59e0b;
        --warning-600: #d97706;

        --error-50: #fef2f2;
        --error-500: #ef4444;
        --error-600: #dc2626;

        /* Variables din√°micas */
        --background: var(--gray-50);
        --surface: #ffffff;
        --surface-secondary: var(--gray-100);
        --text-primary: var(--gray-900);
        --text-secondary: var(--gray-600);
        --text-tertiary: var(--gray-500);
        --border: var(--gray-200);
        --border-focus: var(--primary-500);
        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1),
          0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1),
          0 4px 6px -4px rgb(0 0 0 / 0.1);
        --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1),
          0 8px 10px -6px rgb(0 0 0 / 0.1);

        /* Tipograf√≠a */
        --font-sans: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          "Roboto", sans-serif;
        --font-mono: "JetBrains Mono", "Fira Code", "Consolas", monospace;

        /* Espaciado */
        --space-1: 0.25rem;
        --space-2: 0.5rem;
        --space-3: 0.75rem;
        --space-4: 1rem;
        --space-5: 1.25rem;
        --space-6: 1.5rem;
        --space-8: 2rem;
        --space-10: 2.5rem;
        --space-12: 3rem;
        --space-16: 4rem;
        --space-20: 5rem;

        /* Border radius */
        --radius-sm: 0.375rem;
        --radius: 0.5rem;
        --radius-md: 0.75rem;
        --radius-lg: 1rem;
        --radius-xl: 1.5rem;
        --radius-2xl: 2rem;

        /* Transiciones */
        --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
        --transition: 200ms cubic-bezier(0.4, 0, 0.2, 1);
        --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);
      }

      /* Tema oscuro */
      [data-theme="dark"] {
        --background: var(--gray-900);
        --surface: var(--gray-800);
        --surface-secondary: var(--gray-700);
        --text-primary: var(--gray-100);
        --text-secondary: var(--gray-300);
        --text-tertiary: var(--gray-400);
        --border: var(--gray-600);
        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
        --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.3), 0 1px 2px -1px rgb(0 0 0 / 0.3);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.3),
          0 2px 4px -2px rgb(0 0 0 / 0.3);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3),
          0 4px 6px -4px rgb(0 0 0 / 0.3);
        --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.3),
          0 8px 10px -6px rgb(0 0 0 / 0.3);
      }

      /* Reset CSS profesional */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: var(--font-sans);
      }

      body {
        margin: 0;
        font-family: var(--font-sans);
        background-color: var(--background);
        color: var(--text-primary);
        line-height: 1.5;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        transition: background-color var(--transition), color var(--transition);
      }

      /* Scrollbar personalizada */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: var(--surface-secondary);
      }

      ::-webkit-scrollbar-thumb {
        background: var(--gray-400);
        border-radius: var(--radius);
        transition: background-color var(--transition);
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--gray-500);
      }

      /* Layout principal */
      .app {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .app-header {
        background: var(--surface);
        border-bottom: 1px solid var(--border);
        padding: var(--space-4) var(--space-6);
        position: sticky;
        top: 0;
        z-index: 50;
        backdrop-filter: blur(10px);
        background: rgba(255, 255, 255, 0.95);
        transition: all var(--transition);
      }

      [data-theme="dark"] .app-header {
        background: rgba(31, 41, 55, 0.95);
      }

      .header-content {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: var(--space-4);
      }

      .brand {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        text-decoration: none;
        color: var(--text-primary);
      }

      .brand-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(
          135deg,
          var(--primary-500),
          var(--primary-600)
        );
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: white;
      }

      .brand-text {
        display: flex;
        flex-direction: column;
      }

      .brand-name {
        font-size: 1.25rem;
        font-weight: 700;
        line-height: 1.2;
        background: linear-gradient(
          135deg,
          var(--primary-600),
          var(--accent-600)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .brand-tagline {
        font-size: 0.75rem;
        color: var(--text-secondary);
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: var(--space-3);
      }

      .theme-toggle {
        width: 44px;
        height: 44px;
        border-radius: var(--radius-md);
        border: 1px solid var(--border);
        background: var(--surface);
        color: var(--text-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all var(--transition);
        font-size: 1.25rem;
      }

      .theme-toggle:hover {
        background: var(--surface-secondary);
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
      }

      /* Layout principal */
      .main-container {
        flex: 1;
        max-width: 1400px;
        margin: 0 auto;
        padding: var(--space-8) var(--space-6);
        width: 100%;
      }

      .dashboard-grid {
        display: grid;
        grid-template-columns: 420px 1fr;
        gap: var(--space-8);
        height: calc(100vh - 120px);
        min-height: 800px;
      }

      /* Paneles */
      .panel {
        background: var(--surface);
        border-radius: var(--radius-xl);
        border: 1px solid var(--border);
        box-shadow: var(--shadow);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        transition: box-shadow var(--transition);
      }

      .panel:hover {
        box-shadow: var(--shadow-lg);
      }

      .panel-header {
        padding: var(--space-6);
        border-bottom: 1px solid var(--border);
        background: linear-gradient(
          135deg,
          var(--primary-50),
          var(--accent-50)
        );
      }

      [data-theme="dark"] .panel-header {
        background: linear-gradient(135deg, var(--gray-800), var(--gray-700));
      }

      .panel-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: var(--space-2);
      }

      .panel-subtitle {
        font-size: 0.875rem;
        color: var(--text-secondary);
        margin-top: var(--space-1);
      }

      .panel-content {
        flex: 1;
        padding: var(--space-6);
        overflow-y: auto;
      }

      /* Formulario */
      .form-section {
        margin-bottom: var(--space-8);
      }

      .form-section:last-child {
        margin-bottom: 0;
      }

      .section-header {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        margin-bottom: var(--space-4);
        padding-bottom: var(--space-2);
        border-bottom: 1px solid var(--border);
      }

      .section-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
      }

      .section-icon {
        font-size: 1.25rem;
      }

      .form-grid {
        display: grid;
        gap: var(--space-4);
      }

      .form-grid.cols-2 {
        grid-template-columns: 1fr 1fr;
      }

      .form-field {
        display: flex;
        flex-direction: column;
        gap: var(--space-2);
      }

      .form-label {
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--text-primary);
      }

      .form-input,
      .form-textarea {
        width: 100%;
        padding: var(--space-3) var(--space-4);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        background: var(--surface);
        color: var(--text-primary);
        font-size: 0.875rem;
        font-family: var(--font-sans);
        transition: all var(--transition);
        position: relative;
      }

      .form-input:focus,
      .form-textarea:focus {
        outline: none;
        border-color: var(--border-focus);
        box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.1);
      }

      .form-input.error {
        border-color: var(--error-500);
        box-shadow: 0 0 0 3px var(--error-50);
      }

      .form-input:disabled {
        background: var(--surface-secondary);
        cursor: not-allowed;
        opacity: 0.6;
      }

      .input-wrapper {
        position: relative;
      }

      .input-unit {
        position: absolute;
        right: var(--space-3);
        top: 50%;
        transform: translateY(-50%);
        font-size: 0.75rem;
        color: var(--text-tertiary);
        font-weight: 500;
        pointer-events: none;
      }

      .form-textarea {
        resize: vertical;
        min-height: 80px;
      }

      .form-error {
        font-size: 0.75rem;
        color: var(--error-500);
        margin-top: var(--space-1);
      }

      .form-help {
        font-size: 0.75rem;
        color: var(--text-tertiary);
        margin-top: var(--space-1);
      }

      /* Botones */
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-2);
        padding: var(--space-3) var(--space-6);
        border-radius: var(--radius-md);
        font-weight: 600;
        font-size: 0.875rem;
        text-decoration: none;
        border: none;
        cursor: pointer;
        transition: all var(--transition);
        font-family: var(--font-sans);
        min-height: 44px;
        position: relative;
        overflow: hidden;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--primary-500),
          var(--primary-600)
        );
        color: white;
        box-shadow: var(--shadow);
      }

      .btn-primary:hover:not(:disabled) {
        background: linear-gradient(
          135deg,
          var(--primary-600),
          var(--primary-700)
        );
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
      }

      .btn-secondary {
        background: var(--surface);
        color: var(--text-primary);
        border: 1px solid var(--border);
      }

      .btn-secondary:hover:not(:disabled) {
        background: var(--surface-secondary);
        transform: translateY(-1px);
      }

      .btn-lg {
        padding: var(--space-4) var(--space-8);
        font-size: 1rem;
        min-height: 52px;
      }

      .btn-full {
        width: 100%;
      }

      .btn-loading {
        color: transparent;
      }

      .btn-loading::after {
        content: "";
        position: absolute;
        width: 20px;
        height: 20px;
        border: 2px solid transparent;
        border-top: 2px solid currentColor;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        color: white;
      }

      .form-actions {
        display: flex;
        flex-direction: column;
        gap: var(--space-3);
        margin-top: var(--space-8);
      }

      /* Panel de resultados */
      .results-panel {
        position: relative;
      }

      .results-empty {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 400px;
        text-align: center;
        color: var(--text-tertiary);
      }

      .results-empty-icon {
        font-size: 4rem;
        margin-bottom: var(--space-4);
        opacity: 0.5;
      }

      .results-empty-title {
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: var(--space-2);
      }

      .results-empty-text {
        font-size: 0.875rem;
      }

      .results-tabs {
        display: flex;
        background: var(--surface-secondary);
        border-radius: var(--radius-md);
        padding: var(--space-1);
        margin-bottom: var(--space-6);
      }

      .tab-button {
        flex: 1;
        padding: var(--space-2) var(--space-4);
        background: transparent;
        border: none;
        border-radius: var(--radius);
        color: var(--text-secondary);
        font-weight: 500;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all var(--transition);
        font-family: var(--font-sans);
      }

      .tab-button.active {
        background: var(--surface);
        color: var(--primary-600);
        box-shadow: var(--shadow-sm);
        transform: translateY(-1px);
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
        animation: fadeIn 0.3s ease;
      }

      /* M√©tricas */
      .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--space-4);
        margin-bottom: var(--space-6);
      }

      .metric-card {
        background: var(--surface-secondary);
        border-radius: var(--radius-lg);
        padding: var(--space-5);
        border: 1px solid var(--border);
        transition: all var(--transition);
        position: relative;
        overflow: hidden;
      }

      .metric-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(
          90deg,
          var(--primary-500),
          var(--primary-600)
        );
      }

      .metric-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      .metric-header {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        margin-bottom: var(--space-3);
      }

      .metric-icon {
        font-size: 1.5rem;
      }

      .metric-label {
        font-size: 0.875rem;
        color: var(--text-secondary);
        font-weight: 500;
      }

      .metric-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary-600);
        margin-bottom: var(--space-2);
        font-family: var(--font-mono);
      }

      .metric-description {
        font-size: 0.75rem;
        color: var(--text-tertiary);
        line-height: 1.4;
      }

      .metric-badge {
        display: inline-flex;
        align-items: center;
        padding: var(--space-1) var(--space-2);
        border-radius: var(--radius);
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.025em;
        margin-top: var(--space-2);
      }

      .badge-excellent {
        background: var(--success-50);
        color: var(--success-600);
      }

      .badge-good {
        background: var(--primary-50);
        color: var(--primary-600);
      }

      .badge-regular {
        background: var(--warning-50);
        color: var(--warning-600);
      }

      .badge-poor {
        background: var(--error-50);
        color: var(--error-600);
      }

      /* Gr√°ficos */
      .charts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: var(--space-6);
        margin-bottom: var(--space-6);
      }

      .chart-container {
        background: var(--surface-secondary);
        border-radius: var(--radius-lg);
        padding: var(--space-6);
        border: 1px solid var(--border);
      }

      .chart-header {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        margin-bottom: var(--space-6);
      }

      .chart-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
      }

      .chart-wrapper {
        position: relative;
        height: 300px;
      }

      /* An√°lisis */
      .analysis-section {
        background: var(--surface-secondary);
        border-radius: var(--radius-lg);
        padding: var(--space-6);
        margin-bottom: var(--space-6);
        border: 1px solid var(--border);
      }

      .analysis-header {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        margin-bottom: var(--space-4);
      }

      .analysis-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--text-primary);
      }

      .benchmark-list {
        display: flex;
        flex-direction: column;
        gap: var(--space-3);
      }

      .benchmark-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--space-3);
        background: var(--surface);
        border-radius: var(--radius);
        border: 1px solid var(--border);
      }

      .benchmark-label {
        font-size: 0.875rem;
        color: var(--text-secondary);
        font-weight: 500;
      }

      .benchmark-value {
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--text-primary);
        font-family: var(--font-mono);
      }

      .benchmark-highlight {
        border-color: var(--primary-200);
        background: var(--primary-50);
      }

      /* Notificaciones */
      .notification {
        position: fixed;
        top: var(--space-6);
        right: var(--space-6);
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        padding: var(--space-4);
        box-shadow: var(--shadow-xl);
        z-index: 100;
        display: flex;
        align-items: center;
        gap: var(--space-3);
        max-width: 400px;
        animation: slideInRight 0.3s ease;
      }

      .notification.success {
        border-left: 4px solid var(--success-500);
      }

      .notification.error {
        border-left: 4px solid var(--error-500);
      }

      .notification-icon {
        font-size: 1.25rem;
      }

      .notification-content {
        flex: 1;
      }

      .notification-title {
        font-size: 0.875rem;
        font-weight: 600;
        margin-bottom: var(--space-1);
      }

      .notification-message {
        font-size: 0.75rem;
        color: var(--text-secondary);
      }

      /* Animaciones */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(100%);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes slideOutRight {
        from {
          opacity: 1;
          transform: translateX(0);
        }
        to {
          opacity: 0;
          transform: translateX(100%);
        }
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .fade-in {
        animation: fadeIn 0.6s ease;
      }

      /* Responsive Design */
      @media (max-width: 1200px) {
        .dashboard-grid {
          grid-template-columns: 1fr;
          height: auto;
          min-height: auto;
        }

        .charts-grid {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .main-container {
          padding: var(--space-4);
        }

        .dashboard-grid {
          gap: var(--space-4);
        }

        .panel-content {
          padding: var(--space-4);
        }

        .form-grid.cols-2 {
          grid-template-columns: 1fr;
        }

        .metrics-grid {
          grid-template-columns: 1fr;
        }

        .header-content {
          padding: var(--space-3);
        }

        .brand-text {
          display: none;
        }

        .notification {
          top: var(--space-4);
          right: var(--space-4);
          left: var(--space-4);
          max-width: none;
        }
      }

      @media (max-width: 480px) {
        .main-container {
          padding: var(--space-2);
        }

        .panel-content {
          padding: var(--space-3);
        }

        .panel-header {
          padding: var(--space-4);
        }
      }

      /* Estados de carga */
      .loading-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10;
        border-radius: var(--radius-xl);
      }

      [data-theme="dark"] .loading-overlay {
        background: rgba(31, 41, 55, 0.8);
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 4px solid var(--gray-200);
        border-top: 4px solid var(--primary-500);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      /* Validaci√≥n visual */
      .form-field.error .form-label {
        color: var(--error-500);
      }

      .form-field.success .form-input {
        border-color: var(--success-500);
      }

      .form-field.success .form-label {
        color: var(--success-600);
      }

      /* Accesibilidad */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      /* Focus visible */
      .btn:focus-visible,
      .theme-toggle:focus-visible,
      .tab-button:focus-visible {
        outline: 2px solid var(--primary-500);
        outline-offset: 2px;
      }
    </style>
  </head>
  <body data-theme="light">
    <div class="app">
      <!-- Header -->
      <header class="app-header">
        <div class="header-content">
          <a href="#" class="brand">
            <div class="brand-icon">üêî</div>
            <div class="brand-text">
              <div class="brand-name">MacPollo Analytics</div>
              <div class="brand-tagline">Sistema de An√°lisis Industrial</div>
            </div>
          </a>

          <div class="header-actions">
            <button
              class="theme-toggle"
              id="themeToggle"
              aria-label="Cambiar tema"
            >
              <span id="themeIcon">üåô</span>
            </button>
          </div>
        </div>
      </header>

      <!-- Contenido principal -->
      <main class="main-container">
        <div class="dashboard-grid">
          <!-- Panel de entrada de datos -->
          <div class="panel fade-in">
            <div class="panel-header">
              <h2 class="panel-title">
                <span>üìä</span>
                Datos del Proceso
              </h2>
              <p class="panel-subtitle">
                Ingresa la informaci√≥n de tu proceso de limpieza
              </p>
            </div>

            <div class="panel-content">
              <form id="processForm" novalidate>
                <!-- Datos de producci√≥n -->
                <div class="form-section">
                  <div class="section-header">
                    <span class="section-icon">üêî</span>
                    <h3 class="section-title">Datos de Producci√≥n</h3>
                  </div>

                  <div class="form-grid">
                    <div class="form-field" id="field-kilosPollo">
                      <label class="form-label" for="kilosPollo"
                        >Kilos de Pollo Procesados *</label
                      >
                      <div class="input-wrapper">
                        <input
                          type="number"
                          id="kilosPollo"
                          name="kilosPollo"
                          class="form-input"
                          placeholder="1000.00"
                          step="0.01"
                          min="0.01"
                          required
                          autocomplete="off"
                        />
                        <span class="input-unit">kg</span>
                      </div>
                      <div class="form-help">
                        Cantidad total de pollo procesado en el lote
                      </div>
                      <div class="form-error" id="error-kilosPollo"></div>
                    </div>
                  </div>
                </div>

                <!-- Consumo de agua -->
                <div class="form-section">
                  <div class="section-header">
                    <span class="section-icon">üíß</span>
                    <h3 class="section-title">Consumo de Agua</h3>
                  </div>

                  <div class="form-grid cols-2">
                    <div class="form-field" id="field-aguaConsumida">
                      <label class="form-label" for="aguaConsumida"
                        >Metros C√∫bicos Consumidos *</label
                      >
                      <div class="input-wrapper">
                        <input
                          type="number"
                          id="aguaConsumida"
                          name="aguaConsumida"
                          class="form-input"
                          placeholder="15.50"
                          step="0.01"
                          min="0"
                          required
                          autocomplete="off"
                        />
                        <span class="input-unit">m¬≥</span>
                      </div>
                      <div class="form-error" id="error-aguaConsumida"></div>
                    </div>

                    <div class="form-field" id="field-costoAgua">
                      <label class="form-label" for="costoAgua"
                        >Costo por m¬≥ *</label
                      >
                      <div class="input-wrapper">
                        <input
                          type="number"
                          id="costoAgua"
                          name="costoAgua"
                          class="form-input"
                          placeholder="4500"
                          step="1"
                          min="0"
                          required
                          autocomplete="off"
                        />
                        <span class="input-unit">COP</span>
                      </div>
                      <div class="form-error" id="error-costoAgua"></div>
                    </div>
                  </div>
                </div>

                <!-- Insumos qu√≠micos -->
                <div class="form-section">
                  <div class="section-header">
                    <span class="section-icon">üß™</span>
                    <h3 class="section-title">Insumos Qu√≠micos</h3>
                  </div>

                  <div class="form-grid">
                    <div class="form-field" id="field-costoInsumos">
                      <label class="form-label" for="costoInsumos"
                        >Costo Total de Insumos *</label
                      >
                      <div class="input-wrapper">
                        <input
                          type="number"
                          id="costoInsumos"
                          name="costoInsumos"
                          class="form-input"
                          placeholder="250000"
                          step="1"
                          min="0"
                          required
                          autocomplete="off"
                        />
                        <span class="input-unit">COP</span>
                      </div>
                      <div class="form-help">
                        Costo total de todos los productos qu√≠micos utilizados
                      </div>
                      <div class="form-error" id="error-costoInsumos"></div>
                    </div>

                    <div class="form-field">
                      <label class="form-label" for="detalleInsumos"
                        >Detalle de Insumos (Opcional)</label
                      >
                      <textarea
                        id="detalleInsumos"
                        name="detalleInsumos"
                        class="form-textarea"
                        placeholder="Ej: Desinfectante industrial, detergente biodegradable, cloro l√≠quido, sanitizante..."
                        rows="3"
                      ></textarea>
                      <div class="form-help">
                        Describe los insumos utilizados para referencia
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Acciones -->
                <div class="form-actions">
                  <button
                    type="submit"
                    class="btn btn-primary btn-lg btn-full"
                    id="calculateBtn"
                  >
                    <span>üßÆ</span>
                    Calcular An√°lisis
                  </button>

                  <button
                    type="button"
                    class="btn btn-secondary btn-full"
                    id="resetBtn"
                  >
                    <span>üîÑ</span>
                    Limpiar Formulario
                  </button>
                </div>
              </form>
            </div>
          </div>

          <!-- Panel de resultados -->
          <div class="panel fade-in results-panel" id="resultsPanel">
            <div class="panel-header">
              <h2 class="panel-title">
                <span>üìà</span>
                An√°lisis y Estad√≠sticas
              </h2>
              <p class="panel-subtitle">
                Resultados del an√°lisis de costos y eficiencia
              </p>
            </div>

            <div class="panel-content" id="resultsContent">
              <div class="results-empty">
                <div class="results-empty-icon">üìä</div>
                <div class="results-empty-title">Sin datos que mostrar</div>
                <div class="results-empty-text">
                  Ingresa los datos del proceso para ver el an√°lisis completo
                  con m√©tricas, gr√°ficos y recomendaciones espec√≠ficas para
                  MacPollo
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Chart.js desde CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

    <script>
      // Estado de la aplicaci√≥n
      const AppState = {
        currentResults: null,
        charts: {
          pie: null,
          bar: null,
          efficiency: null,
        },
        theme: localStorage.getItem("theme") || "light",
        formData: {},
      };

      // Configuraci√≥n de la aplicaci√≥n para MacPollo
      const AppConfig = {
        benchmarks: {
          costoPorKiloOptimo: 300, // COP
          costoPorKiloPromedio: 500, // COP
          aguaPorKiloOptimo: 20, // litros
          aguaPorKiloPromedio: 30, // litros
        },
        validation: {
          kilosPollo: { min: 0.01, max: 100000 },
          aguaConsumida: { min: 0, max: 10000 },
          costoAgua: { min: 0, max: 50000 }, // COP
          costoInsumos: { min: 0, max: 10000000 }, // COP
        },
      };

      // Utilidad para formatear moneda colombiana
      function formatCOP(amount) {
        return new Intl.NumberFormat("es-CO", {
          style: "currency",
          currency: "COP",
          minimumFractionDigits: 0,
          maximumFractionDigits: 2,
        }).format(amount);
      }

      // Inicializaci√≥n de la aplicaci√≥n
      class MacPolloAnalytics {
        constructor() {
          this.init();
        }

        init() {
          this.setupTheme();
          this.setupForm();
          this.setupEventListeners();
          this.setupAnimations();
        }

        setupTheme() {
          document.documentElement.setAttribute("data-theme", AppState.theme);
          this.updateThemeIcon();

          document
            .getElementById("themeToggle")
            .addEventListener("click", () => {
              AppState.theme = AppState.theme === "light" ? "dark" : "light";
              document.documentElement.setAttribute(
                "data-theme",
                AppState.theme
              );
              localStorage.setItem("theme", AppState.theme);
              this.updateThemeIcon();

              // Actualizar gr√°ficos si existen
              if (AppState.currentResults) {
                setTimeout(
                  () => this.createCharts(AppState.currentResults),
                  100
                );
              }
            });
        }

        updateThemeIcon() {
          const icon = document.getElementById("themeIcon");
          icon.textContent = AppState.theme === "light" ? "üåô" : "‚òÄÔ∏è";
        }

        setupForm() {
          const form = document.getElementById("processForm");
          form.addEventListener("submit", (e) => this.handleSubmit(e));

          // Validaci√≥n en tiempo real
          const inputs = form.querySelectorAll("input[required]");
          inputs.forEach((input) => {
            input.addEventListener("blur", () => this.validateField(input));
            input.addEventListener("input", () => this.clearFieldError(input));
          });

          // Reset form
          document
            .getElementById("resetBtn")
            .addEventListener("click", () => this.resetForm());
        }

        setupEventListeners() {
          // Manejo de errores globales
          window.addEventListener("error", (e) => {
            console.error("Error de aplicaci√≥n:", e.error);
            this.showNotification(
              "error",
              "Error del Sistema",
              "Se produjo un error inesperado. Por favor, recarga la p√°gina."
            );
          });

          // Responsive charts
          window.addEventListener("resize", () => {
            if (AppState.currentResults) {
              this.debounce(
                () => this.createCharts(AppState.currentResults),
                300
              )();
            }
          });
        }

        setupAnimations() {
          const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                entry.target.classList.add("fade-in");
              }
            });
          });

          document
            .querySelectorAll(".panel, .metric-card, .chart-container")
            .forEach((el) => {
              observer.observe(el);
            });
        }

        // Validaci√≥n de campos
        validateField(input) {
          const fieldName = input.name;
          const value = parseFloat(input.value);
          const config = AppConfig.validation[fieldName];

          this.clearFieldError(input);

          if (!input.value.trim()) {
            if (input.required) {
              this.setFieldError(input, "Este campo es obligatorio");
              return false;
            }
            return true;
          }

          if (isNaN(value)) {
            this.setFieldError(input, "Debe ser un n√∫mero v√°lido");
            return false;
          }

          if (config) {
            if (value < config.min) {
              this.setFieldError(
                input,
                `El valor m√≠nimo es ${config.min.toLocaleString("es-CO")}`
              );
              return false;
            }
            if (value > config.max) {
              this.setFieldError(
                input,
                `El valor m√°ximo es ${config.max.toLocaleString("es-CO")}`
              );
              return false;
            }
          }

          // Validaciones espec√≠ficas
          if (fieldName === "aguaConsumida" || fieldName === "kilosPollo") {
            if (value <= 0) {
              this.setFieldError(input, "Debe ser mayor a 0");
              return false;
            }
          }

          this.setFieldSuccess(input);
          return true;
        }

        setFieldError(input, message) {
          const field = input.closest(".form-field");
          const errorElement = field.querySelector(".form-error");

          field.classList.add("error");
          field.classList.remove("success");
          input.classList.add("error");

          if (errorElement) {
            errorElement.textContent = message;
          }
        }

        setFieldSuccess(input) {
          const field = input.closest(".form-field");

          field.classList.remove("error");
          field.classList.add("success");
          input.classList.remove("error");
        }

        clearFieldError(input) {
          const field = input.closest(".form-field");
          const errorElement = field.querySelector(".form-error");

          field.classList.remove("error", "success");
          input.classList.remove("error");

          if (errorElement) {
            errorElement.textContent = "";
          }
        }

        // Manejo del formulario
        async handleSubmit(e) {
          e.preventDefault();

          if (!this.validateForm()) {
            this.showNotification(
              "error",
              "Datos Inv√°lidos",
              "Por favor, corrige los errores antes de continuar"
            );
            return;
          }

          const formData = this.collectFormData();

          try {
            await this.calculateProcess(formData);
          } catch (error) {
            console.error("Error en c√°lculo:", error);
            this.showNotification(
              "error",
              "Error de C√°lculo",
              "No se pudo procesar el an√°lisis. Verifica los datos e intenta nuevamente."
            );
          }
        }

        validateForm() {
          const form = document.getElementById("processForm");
          const inputs = form.querySelectorAll("input[required]");
          let isValid = true;

          inputs.forEach((input) => {
            if (!this.validateField(input)) {
              isValid = false;
            }
          });

          return isValid;
        }

        collectFormData() {
          const formData = new FormData(document.getElementById("processForm"));

          return {
            kilosPollo: parseFloat(formData.get("kilosPollo")) || 0,
            aguaConsumida: parseFloat(formData.get("aguaConsumida")) || 0,
            costoAgua: parseFloat(formData.get("costoAgua")) || 0,
            costoInsumos: parseFloat(formData.get("costoInsumos")) || 0,
            detalleInsumos: formData.get("detalleInsumos") || "",
          };
        }

        async calculateProcess(data) {
          const calculateBtn = document.getElementById("calculateBtn");
          const resultsPanel = document.getElementById("resultsPanel");

          // UI de carga
          calculateBtn.classList.add("btn-loading");
          calculateBtn.disabled = true;

          // Overlay de carga en resultados
          if (!document.querySelector(".loading-overlay")) {
            const overlay = document.createElement("div");
            overlay.className = "loading-overlay";
            overlay.innerHTML = '<div class="loading-spinner"></div>';
            resultsPanel.appendChild(overlay);
          }

          try {
            // Simular procesamiento as√≠ncrono
            await this.delay(1500);

            const results = this.performCalculations(data);
            AppState.currentResults = results;

            this.displayResults(results);
            this.showNotification(
              "success",
              "An√°lisis Completado",
              "Los resultados se han calculado exitosamente para MacPollo"
            );
          } finally {
            // Cleanup UI
            calculateBtn.classList.remove("btn-loading");
            calculateBtn.disabled = false;

            const overlay = document.querySelector(".loading-overlay");
            if (overlay) {
              overlay.remove();
            }
          }
        }

        performCalculations(data) {
          const { kilosPollo, aguaConsumida, costoAgua, costoInsumos } = data;

          // C√°lculos principales
          const costoTotalAgua = aguaConsumida * costoAgua;
          const costoTotal = costoTotalAgua + costoInsumos;
          const costoPorKilo = costoTotal / kilosPollo;
          const aguaPorKilo = aguaConsumida / kilosPollo;
          const litrosAguaPorKilo = aguaPorKilo * 1000;

          // An√°lisis de eficiencia
          const eficienciaAgua = this.calculateEfficiency(
            litrosAguaPorKilo,
            "agua"
          );
          const eficienciaCosto = this.calculateEfficiency(
            costoPorKilo,
            "costo"
          );

          // Porcentajes
          const porcentajeAgua = (costoTotalAgua / costoTotal) * 100;
          const porcentajeInsumos = (costoInsumos / costoTotal) * 100;

          // Comparaci√≥n con benchmarks
          const ahorroVsPromedio =
            ((AppConfig.benchmarks.costoPorKiloPromedio - costoPorKilo) /
              AppConfig.benchmarks.costoPorKiloPromedio) *
            100;
          const ahorroAguaVsPromedio =
            ((AppConfig.benchmarks.aguaPorKiloPromedio - litrosAguaPorKilo) /
              AppConfig.benchmarks.aguaPorKiloPromedio) *
            100;

          return {
            ...data,
            costoTotal,
            costoTotalAgua,
            costoPorKilo,
            aguaPorKilo,
            litrosAguaPorKilo,
            eficienciaAgua,
            eficienciaCosto,
            porcentajeAgua,
            porcentajeInsumos,
            ahorroVsPromedio,
            ahorroAguaVsPromedio,
            benchmarks: AppConfig.benchmarks,
          };
        }

        calculateEfficiency(value, type) {
          if (type === "agua") {
            if (value <= 15) return "excellent";
            if (value <= 25) return "good";
            if (value <= 35) return "regular";
            return "poor";
          }

          if (type === "costo") {
            if (value <= AppConfig.benchmarks.costoPorKiloOptimo)
              return "excellent";
            if (value <= AppConfig.benchmarks.costoPorKiloPromedio)
              return "good";
            if (value <= AppConfig.benchmarks.costoPorKiloPromedio * 1.2)
              return "regular";
            return "poor";
          }

          return "regular";
        }

        displayResults(results) {
          const content = document.getElementById("resultsContent");

          const html = `
                    <div class="results-tabs">
                        <button class="tab-button active" data-tab="metrics">üìä M√©tricas</button>
                        <button class="tab-button" data-tab="charts">üìà Gr√°ficos</button>
                        <button class="tab-button" data-tab="analysis">üîç An√°lisis</button>
                    </div>

                    <div class="tab-content active" id="tab-metrics">
                        ${this.renderMetricsTab(results)}
                    </div>

                    <div class="tab-content" id="tab-charts">
                        ${this.renderChartsTab(results)}
                    </div>

                    <div class="tab-content" id="tab-analysis">
                        ${this.renderAnalysisTab(results)}
                    </div>
                `;

          content.innerHTML = html;
          this.setupTabs();

          // Crear gr√°ficos despu√©s de un delay para asegurar que el DOM est√© listo
          setTimeout(() => this.createCharts(results), 100);
        }

        renderMetricsTab(results) {
          return `
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-header">
                                <span class="metric-icon">üí∞</span>
                                <span class="metric-label">Costo por Kilogramo</span>
                            </div>
                            <div class="metric-value">${formatCOP(
                              results.costoPorKilo
                            )}</div>
                            <div class="metric-description">Costo total del proceso dividido entre kilos procesados</div>
                            <div class="metric-badge badge-${
                              results.eficienciaCosto
                            }">
                                ${this.getEfficiencyLabel(
                                  results.eficienciaCosto
                                )}
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-header">
                                <span class="metric-icon">üíß</span>
                                <span class="metric-label">Agua por Kilogramo</span>
                            </div>
                            <div class="metric-value">${results.litrosAguaPorKilo.toFixed(
                              1
                            )} L</div>
                            <div class="metric-description">Litros de agua consumidos por kilogramo de pollo</div>
                            <div class="metric-badge badge-${
                              results.eficienciaAgua
                            }">
                                ${this.getEfficiencyLabel(
                                  results.eficienciaAgua
                                )}
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-header">
                                <span class="metric-icon">üìä</span>
                                <span class="metric-label">Costo Total</span>
                            </div>
                            <div class="metric-value">${formatCOP(
                              results.costoTotal
                            )}</div>
                            <div class="metric-description">Inversi√≥n total para procesar ${results.kilosPollo.toLocaleString(
                              "es-CO"
                            )} kg</div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-header">
                                <span class="metric-icon">üåä</span>
                                <span class="metric-label">Volumen de Agua</span>
                            </div>
                            <div class="metric-value">${
                              results.aguaConsumida
                            } m¬≥</div>
                            <div class="metric-description">Metros c√∫bicos totales consumidos</div>
                        </div>
                    </div>

                    <div class="analysis-section">
                        <div class="analysis-header">
                            <span>üíº</span>
                            <h3 class="analysis-title">Desglose de Costos</h3>
                        </div>
                        <div class="benchmark-list">
                            <div class="benchmark-item">
                                <span class="benchmark-label">üíß Agua (${
                                  results.aguaConsumida
                                } m¬≥)</span>
                                <span class="benchmark-value">${formatCOP(
                                  results.costoTotalAgua
                                )} (${results.porcentajeAgua.toFixed(
            1
          )}%)</span>
                            </div>
                            <div class="benchmark-item">
                                <span class="benchmark-label">üß™ Insumos Qu√≠micos</span>
                                <span class="benchmark-value">${formatCOP(
                                  results.costoInsumos
                                )} (${results.porcentajeInsumos.toFixed(
            1
          )}%)</span>
                            </div>
                            <div class="benchmark-item benchmark-highlight">
                                <span class="benchmark-label"><strong>üí∞ TOTAL MacPollo</strong></span>
                                <span class="benchmark-value"><strong>${formatCOP(
                                  results.costoTotal
                                )}</strong></span>
                            </div>
                        </div>
                    </div>
                `;
        }

        renderChartsTab(results) {
          return `
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <span>üç∞</span>
                                <h3 class="chart-title">Distribuci√≥n de Costos</h3>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="pieChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-container">
                            <div class="chart-header">
                                <span>üìä</span>
                                <h3 class="chart-title">Comparativa vs Benchmarks</h3>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="barChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <div class="chart-header">
                            <span>üìà</span>
                            <h3 class="chart-title">An√°lisis de Eficiencia MacPollo</h3>
                        </div>
                        <div class="chart-wrapper" style="height: 250px;">
                            <canvas id="efficiencyChart"></canvas>
                        </div>
                    </div>
                `;
        }

        renderAnalysisTab(results) {
          return `
                    <div class="analysis-section">
                        <div class="analysis-header">
                            <span>üéØ</span>
                            <h3 class="analysis-title">Benchmarks de Industria Av√≠cola</h3>
                        </div>
                        <div class="benchmark-list">
                            <div class="benchmark-item">
                                <span class="benchmark-label">Costo √ìptimo por Kg</span>
                                <span class="benchmark-value">${formatCOP(
                                  results.benchmarks.costoPorKiloOptimo
                                )}</span>
                            </div>
                            <div class="benchmark-item">
                                <span class="benchmark-label">Costo Promedio por Kg</span>
                                <span class="benchmark-value">${formatCOP(
                                  results.benchmarks.costoPorKiloPromedio
                                )}</span>
                            </div>
                            <div class="benchmark-item benchmark-highlight">
                                <span class="benchmark-label">Costo MacPollo por Kg</span>
                                <span class="benchmark-value">${formatCOP(
                                  results.costoPorKilo
                                )}</span>
                            </div>
                            ${
                              results.ahorroVsPromedio > 0
                                ? `
                                <div class="benchmark-item" style="border-color: var(--success-500); background: var(--success-50);">
                                    <span class="benchmark-label">‚úÖ Ahorro vs Promedio</span>
                                    <span class="benchmark-value" style="color: var(--success-600);">${results.ahorroVsPromedio.toFixed(
                                      1
                                    )}% menos</span>
                                </div>
                            `
                                : `
                                <div class="benchmark-item" style="border-color: var(--error-500); background: var(--error-50);">
                                    <span class="benchmark-label">‚ö†Ô∏è Diferencia vs Promedio</span>
                                    <span class="benchmark-value" style="color: var(--error-600);">${Math.abs(
                                      results.ahorroVsPromedio
                                    ).toFixed(1)}% m√°s</span>
                                </div>
                            `
                            }
                        </div>
                    </div>

                    <div class="analysis-section">
                        <div class="analysis-header">
                            <span>üîç</span>
                            <h3 class="analysis-title">An√°lisis de Eficiencia de Agua</h3>
                        </div>
                        <div class="benchmark-list">
                            <div class="benchmark-item">
                                <span class="benchmark-label">Uso √ìptimo de Agua</span>
                                <span class="benchmark-value">${
                                  results.benchmarks.aguaPorKiloOptimo
                                } L/kg</span>
                            </div>
                            <div class="benchmark-item">
                                <span class="benchmark-label">Uso Promedio de Agua</span>
                                <span class="benchmark-value">${
                                  results.benchmarks.aguaPorKiloPromedio
                                } L/kg</span>
                            </div>
                            <div class="benchmark-item benchmark-highlight">
                                <span class="benchmark-label">Uso MacPollo</span>
                                <span class="benchmark-value">${results.litrosAguaPorKilo.toFixed(
                                  1
                                )} L/kg</span>
                            </div>
                        </div>
                    </div>

                    ${
                      results.detalleInsumos
                        ? `
                        <div class="analysis-section">
                            <div class="analysis-header">
                                <span>üß™</span>
                                <h3 class="analysis-title">Detalle de Insumos MacPollo</h3>
                            </div>
                            <div style="background: var(--surface-secondary); padding: var(--space-4); border-radius: var(--radius); color: var(--text-secondary); line-height: 1.6; border: 1px solid var(--border);">
                                ${results.detalleInsumos}
                            </div>
                        </div>
                    `
                        : ""
                    }

                    <div class="analysis-section">
                        <div class="analysis-header">
                            <span>üí°</span>
                            <h3 class="analysis-title">Recomendaciones para MacPollo</h3>
                        </div>
                        <div class="benchmark-list">
                            ${this.generateRecommendations(results)}
                        </div>
                    </div>
                `;
        }

        generateRecommendations(results) {
          let recommendations = [];

          if (results.litrosAguaPorKilo > 35) {
            recommendations.push({
              type: "warning",
              title: "Optimizaci√≥n de Agua Cr√≠tica",
              description:
                "Implementar sistemas de recirculaci√≥n o cambiar tecnolog√≠a de limpieza",
            });
          } else if (results.litrosAguaPorKilo > 25) {
            recommendations.push({
              type: "info",
              title: "Mejora del Uso de Agua",
              description:
                "Evaluar sistemas de ahorro de agua m√°s eficientes para MacPollo",
            });
          }

          if (
            results.costoPorKilo > AppConfig.benchmarks.costoPorKiloPromedio
          ) {
            recommendations.push({
              type: "warning",
              title: "Oportunidad de Reducci√≥n de Costos",
              description:
                "Analizar proveedores alternativos y optimizar procesos de limpieza",
            });
          }

          if (results.porcentajeInsumos > 70) {
            recommendations.push({
              type: "info",
              title: "An√°lisis de Insumos",
              description: `Los insumos representan ${results.porcentajeInsumos.toFixed(
                1
              )}% del costo total de limpieza`,
            });
          }

          if (results.ahorroVsPromedio > 10) {
            recommendations.push({
              type: "success",
              title: "Proceso Altamente Eficiente",
              description:
                "MacPollo est√° operando por encima de los est√°ndares de la industria",
            });
          }

          if (recommendations.length === 0) {
            recommendations.push({
              type: "success",
              title: "Proceso Eficiente",
              description:
                "MacPollo muestra indicadores de eficiencia satisfactorios",
            });
          }

          return recommendations
            .map(
              (rec) => `
                    <div class="benchmark-item">
                        <span class="benchmark-label">${
                          rec.type === "success"
                            ? "‚úÖ"
                            : rec.type === "warning"
                            ? "‚ö†Ô∏è"
                            : "‚ÑπÔ∏è"
                        } ${rec.title}</span>
                        <span class="benchmark-value">${rec.description}</span>
                    </div>
                `
            )
            .join("");
        }

        setupTabs() {
          const tabButtons = document.querySelectorAll(".tab-button");
          const tabContents = document.querySelectorAll(".tab-content");

          tabButtons.forEach((button) => {
            button.addEventListener("click", () => {
              const tabName = button.dataset.tab;

              // Actualizar botones
              tabButtons.forEach((btn) => btn.classList.remove("active"));
              button.classList.add("active");

              // Actualizar contenido
              tabContents.forEach((content) =>
                content.classList.remove("active")
              );
              document.getElementById(`tab-${tabName}`).classList.add("active");

              // Recrear gr√°ficos si es necesario
              if (tabName === "charts" && AppState.currentResults) {
                setTimeout(
                  () => this.createCharts(AppState.currentResults),
                  100
                );
              }
            });
          });
        }

        createCharts(results) {
          this.destroyCharts();

          const isDark = AppState.theme === "dark";
          const textColor = isDark ? "#e2e8f0" : "#4b5563";
          const gridColor = isDark ? "#4b5563" : "#e5e7eb";

          // Configuraci√≥n base para gr√°ficos
          const baseConfig = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                labels: {
                  color: textColor,
                  font: {
                    family: "'Inter', sans-serif",
                  },
                },
              },
            },
          };

          // Gr√°fico de distribuci√≥n (Doughnut)
          const pieCtx = document.getElementById("pieChart");
          if (pieCtx) {
            AppState.charts.pie = new Chart(pieCtx, {
              type: "doughnut",
              data: {
                labels: ["Agua", "Insumos Qu√≠micos"],
                datasets: [
                  {
                    data: [results.costoTotalAgua, results.costoInsumos],
                    backgroundColor: ["#f97316", "#ea580c"],
                    borderWidth: 0,
                    cutout: "60%",
                  },
                ],
              },
              options: {
                ...baseConfig,
                plugins: {
                  ...baseConfig.plugins,
                  tooltip: {
                    callbacks: {
                      label: (context) => {
                        const percentage = (
                          (context.parsed / results.costoTotal) *
                          100
                        ).toFixed(1);
                        return `${context.label}: ${formatCOP(
                          context.parsed
                        )} (${percentage}%)`;
                      },
                    },
                  },
                },
              },
            });
          }

          // Gr√°fico de comparaci√≥n (Bar)
          const barCtx = document.getElementById("barChart");
          if (barCtx) {
            AppState.charts.bar = new Chart(barCtx, {
              type: "bar",
              data: {
                labels: ["Costo por Kg (COP)", "Agua por Kg (L)"],
                datasets: [
                  {
                    label: "√ìptimo",
                    data: [
                      results.benchmarks.costoPorKiloOptimo,
                      results.benchmarks.aguaPorKiloOptimo,
                    ],
                    backgroundColor: "#10b981",
                    borderRadius: 6,
                  },
                  {
                    label: "Promedio Industria",
                    data: [
                      results.benchmarks.costoPorKiloPromedio,
                      results.benchmarks.aguaPorKiloPromedio,
                    ],
                    backgroundColor: "#f59e0b",
                    borderRadius: 6,
                  },
                  {
                    label: "MacPollo",
                    data: [results.costoPorKilo, results.litrosAguaPorKilo],
                    backgroundColor: "#f97316",
                    borderRadius: 6,
                  },
                ],
              },
              options: {
                ...baseConfig,
                scales: {
                  y: {
                    beginAtZero: true,
                    ticks: {
                      color: textColor,
                      font: {
                        family: "'Inter', sans-serif",
                      },
                    },
                    grid: { color: gridColor },
                  },
                  x: {
                    ticks: {
                      color: textColor,
                      font: {
                        family: "'Inter', sans-serif",
                      },
                    },
                    grid: { color: gridColor },
                  },
                },
              },
            });
          }

          // Gr√°fico de eficiencia (Radar)
          const effCtx = document.getElementById("efficiencyChart");
          if (effCtx) {
            const efficiencyScores = {
              agua: this.getEfficiencyScore(results.eficienciaAgua),
              costo: this.getEfficiencyScore(results.eficienciaCosto),
              general:
                (this.getEfficiencyScore(results.eficienciaAgua) +
                  this.getEfficiencyScore(results.eficienciaCosto)) /
                2,
            };

            AppState.charts.efficiency = new Chart(effCtx, {
              type: "radar",
              data: {
                labels: [
                  "Eficiencia de Agua",
                  "Eficiencia de Costo",
                  "Eficiencia General",
                ],
                datasets: [
                  {
                    label: "MacPollo (%)",
                    data: [
                      efficiencyScores.agua,
                      efficiencyScores.costo,
                      efficiencyScores.general,
                    ],
                    borderColor: "#f97316",
                    backgroundColor: "rgba(249, 115, 22, 0.1)",
                    pointBackgroundColor: "#f97316",
                    pointBorderColor: "#ffffff",
                    pointBorderWidth: 2,
                    pointRadius: 6,
                  },
                ],
              },
              options: {
                ...baseConfig,
                scales: {
                  r: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                      color: textColor,
                      callback: (value) => value + "%",
                      font: {
                        family: "'Inter', sans-serif",
                      },
                    },
                    grid: { color: gridColor },
                    pointLabels: {
                      color: textColor,
                      font: {
                        family: "'Inter', sans-serif",
                      },
                    },
                  },
                },
              },
            });
          }
        }

        destroyCharts() {
          Object.values(AppState.charts).forEach((chart) => {
            if (chart) {
              chart.destroy();
            }
          });
          AppState.charts = { pie: null, bar: null, efficiency: null };
        }

        getEfficiencyLabel(efficiency) {
          const labels = {
            excellent: "Excelente",
            good: "Buena",
            regular: "Regular",
            poor: "Necesita Mejoras",
          };
          return labels[efficiency] || "Regular";
        }

        getEfficiencyScore(efficiency) {
          const scores = {
            excellent: 95,
            good: 80,
            regular: 60,
            poor: 40,
          };
          return scores[efficiency] || 60;
        }

        resetForm() {
          document.getElementById("processForm").reset();

          // Limpiar errores
          document.querySelectorAll(".form-field").forEach((field) => {
            field.classList.remove("error", "success");
          });
          document.querySelectorAll(".form-error").forEach((error) => {
            error.textContent = "";
          });

          // Limpiar resultados
          document.getElementById("resultsContent").innerHTML = `
                    <div class="results-empty">
                        <div class="results-empty-icon">üìä</div>
                        <div class="results-empty-title">Sin datos que mostrar</div>
                        <div class="results-empty-text">Ingresa los datos del proceso para ver el an√°lisis completo con m√©tricas, gr√°ficos y recomendaciones espec√≠ficas para MacPollo</div>
                    </div>
                `;

          this.destroyCharts();
          AppState.currentResults = null;

          this.showNotification(
            "success",
            "Formulario Limpiado",
            "Todos los campos han sido restablecidos"
          );
        }

        showNotification(type, title, message) {
          const notification = document.createElement("div");
          notification.className = `notification ${type}`;

          const icon =
            type === "success" ? "‚úÖ" : type === "error" ? "‚ùå" : "‚ÑπÔ∏è";

          notification.innerHTML = `
                    <div class="notification-icon">${icon}</div>
                    <div class="notification-content">
                        <div class="notification-title">${title}</div>
                        <div class="notification-message">${message}</div>
                    </div>
                `;

          document.body.appendChild(notification);

          setTimeout(() => {
            notification.style.animation = "slideOutRight 0.3s ease forwards";
            setTimeout(() => notification.remove(), 300);
          }, 4000);
        }

        // Utilidades
        delay(ms) {
          return new Promise((resolve) => setTimeout(resolve, ms));
        }

        debounce(func, wait) {
          let timeout;
          return function executedFunction(...args) {
            const later = () => {
              clearTimeout(timeout);
              func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
          };
        }
      }

      // Inicializar aplicaci√≥n cuando el DOM est√© listo
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", () => {
          new MacPolloAnalytics();
        });
      } else {
        new MacPolloAnalytics();
      }
    </script>
  </body>
</html>
